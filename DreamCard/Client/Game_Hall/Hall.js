var __reflect=this&&this.__reflect||function(e,t,r){e.__class__=t,r?r.push(t):r=[t],e.__types__=e.__types__?r.concat(e.__types__):r},__extends=this&&this.__extends||function(e,t){function r(){this.constructor=e}for(var a in t)t.hasOwnProperty(a)&&(e[a]=t[a]);r.prototype=t.prototype,e.prototype=new r},HallCmdDef;!function(e){e[e.CMD_Hall=100]="CMD_Hall",e[e.CMD_Shop=103]="CMD_Shop",e[e.CMD_ShopBy=104]="CMD_ShopBy",e[e.CMD_Bag=105]="CMD_Bag",e[e.CMD_Baguse=106]="CMD_Baguse",e[e.CMD_Notice=107]="CMD_Notice",e[e.CMD_CardWiewLists=228]="CMD_CardWiewLists",e[e.CMD_GET_TEAM_CONFIG=110]="CMD_GET_TEAM_CONFIG",e[e.CMD_GET_TEAM_LIST=111]="CMD_GET_TEAM_LIST",e[e.CMD_CHANGE_BATTLE_TEAM=112]="CMD_CHANGE_BATTLE_TEAM",e[e.CMD_GET_CARD_LIST_TEAMSET=113]="CMD_GET_CARD_LIST_TEAMSET",e[e.CMD_GET_CARD_DETAIL_TEAMSET=114]="CMD_GET_CARD_DETAIL_TEAMSET",e[e.CMD_SAVE_TEAMSET=115]="CMD_SAVE_TEAMSET",e[e.CMD_GET_FROM_FETTER_TEAM=116]="CMD_GET_FROM_FETTER_TEAM",e[e.CMD_GET_FROM_FETTER_TEAMSET=117]="CMD_GET_FROM_FETTER_TEAMSET",e[e.CMD_GET_MOLLBY_CONFIG=124]="CMD_GET_MOLLBY_CONFIG",e[e.CMD_Award=125]="CMD_Award",e[e.CMD_Award10=126]="CMD_Award10",e[e.CMD_MyCardList=127]="CMD_MyCardList",e[e.CMD_SetConfig=128]="CMD_SetConfig",e[e.CMD_CreateCardPool=129]="CMD_CreateCardPool",e[e.CMD_GETUPADTEGOLD=130]="CMD_GETUPADTEGOLD",e[e.CMD_GET_CARD_LIST=150]="CMD_GET_CARD_LIST",e[e.CMD_GET_CARD_DETAIL=151]="CMD_GET_CARD_DETAIL",e[e.CMD_GET_FETTERS_CONFIG=160]="CMD_GET_FETTERS_CONFIG",e[e.CMD_MATCH_PVP=180]="CMD_MATCH_PVP",e[e.CMD_DISMATCH_PVP=181]="CMD_DISMATCH_PVP",e[e.CMD_GET_MATCH_PVP_INFO=182]="CMD_GET_MATCH_PVP_INFO",e[e.CMD_HALL_GET_MATCH_PVP_INFO=183]="CMD_HALL_GET_MATCH_PVP_INFO",e[e.CMD_UPGRADE_COMMANDER=200]="CMD_UPGRADE_COMMANDER",e[e.CMD_GET_UPGRADE_MATERIAL_LIST=201]="CMD_GET_UPGRADE_MATERIAL_LIST",e[e.CMD_BagDestory=206]="CMD_BagDestory",e[e.CMD_Record=208]="CMD_Record",e[e.CMD_GET_MOLL_CONFIG=213]="CMD_GET_MOLL_CONFIG",e[e.CMD_BaguseUp=216]="CMD_BaguseUp"}(HallCmdDef||(HallCmdDef={}));var Hall;!function(e){function t(){return{}}function r(e,t){UIManager.getInstance().registerViewNameByGkid(1,HallView,"大厅"),c=t,l(),o(e)}function a(){null!=c&&(c(),c=null)}function n(){i(),s()}function o(e){UIManager.getInstance().showUI(HallView,GameScene.VIEW_LAYER_NUMBER,-1,0,0,0,e)}function i(){UIManager.getInstance().hideUI(HallView)}function l(){p||(p=new HallDecoder);var e=BaseDecode.getInstance();e.registerDecoder(p)}function s(){var e=BaseDecode.getInstance();e.removeDecoder(p)}var c;e.getResConf=t,e.init=r,e.onGameShow=a,e.dispose=n;var p}(Hall||(Hall={}));var CardHeadView=function(e){function t(){return e.call(this,t.NAME)||this}return __extends(t,e),t.prototype.week=function(){var t=this,r=e.prototype.getData.call(this);if(null!=r){var a=r.icon;t.setCardHead(a);var n=r.rarity;t.setCardHeadFrame(n);var o=r.element;t.setAttr(o);var i=r.level,l=r.generation;t.setLvl(i,l);var s=r.name;t.setCardName(s);var c=r.combat;t.setCombat(c),t.showSimple()}},t.prototype.showSimple=function(){this.labGene.$setVisible(!1),this.groupLevel.$setVisible(!1)},t.prototype.sleep=function(){},t.prototype.cleanArray=function(e){if(!(null==e||e.length<=0))for(var t=e.length-1;t>=0;t--){var r=e[t];if(null!=r){var a=r.parent;a.removeChild(r)}e.splice(t,1)}},t.prototype.setCardHead=function(e){null!=e&&void 0!=e&&(this.imgHead.source="headImg0Sheet_json."+e)},t.prototype.setCardHeadFrame=function(e){switch(e){case"common":this.imgHeadFrame.source="combatRecordSheet_json.a86x86_0";break;case"rare":this.imgHeadFrame.source="combatRecordSheet_json.a86x86_2";break;case"epic":this.imgHeadFrame.source="combatRecordSheet_json.a86x86_4";break;case"legendary":this.imgHeadFrame.source="combatRecordSheet_json.a86x86_3";break;case"mythical":this.imgHeadFrame.source="combatRecordSheet_json.a86x86_1"}},t.prototype.setAttr=function(e){switch(e){case"fire":this.imgAttr.source="combatRecordSheet_json.a28x28_0";break;case"metal":this.imgAttr.source="combatRecordSheet_json.a28x28_1";break;case"wood":this.imgAttr.source="combatRecordSheet_json.a28x28_2";break;case"water":this.imgAttr.source="combatRecordSheet_json.a28x28_3";break;case"earth":this.imgAttr.source="combatRecordSheet_json.a28x28_4"}},t.prototype.setCardName=function(e){this.labCardName.text=e},t.prototype.setCombat=function(e){this.labCombat.text="战力："+e},t.prototype.setLvl=function(e,t){for(var r=0;e>r;r++){var a=new eui.Image;this.groupLevel.addChild(a),a.source="combatRecordSheet_json.a15x15_1",a.x=15*r,a.y=0}this.labGene.text=t+"代"},t.NAME="CardHeadViewSkin",t}(BaseView);__reflect(CardHeadView.prototype,"CardHeadView");var CardItemView=function(e){function t(){var r=e.call(this,t.NAME)||this;return r.arrLetter=["a","b","c","d","e","f","g"],r}return __extends(t,e),t.prototype.week=function(){},t.prototype.sleep=function(){},t.prototype.setImgBG=function(e){var t=this;t.imgBG.source="lobbyImg1Sheet_json."+t.arrLetter[e-1]+"196x194"},t.prototype.getViewWidth=function(){return this.groupCI.width},t.prototype.getViewHeight=function(){return this.groupCI.height},t.NAME="CardItemSkin",t}(IBaseView);__reflect(CardItemView.prototype,"CardItemView");var CardOperationView=function(e){function t(){var r=e.call(this,t.NAME)||this;return r.bagItemChoose=1,r.arrBtnGroup=new Array,r.arrSkillList=new Array,r.curBtnIndex=-1,r.cardAttrInit=!1,r.cardFetterInit=!1,r.cardShowInit=!1,r.arrFetterItemView=new Array,r.arrAttrList=new Array,r.arrAttrLine=new Array,r.isTouchMove=!1,r.curCardView=null,r.myCardView=null,r.skillAry=[],r.skillOpenAry=[],r.unlockOpenAry=[],r}return __extends(t,e),t.prototype.week=function(){var t=this;t.hasEventListener(egret.TouchEvent.TOUCH_TAP)||t.addEventListener(egret.TouchEvent.TOUCH_TAP,t.touchTap,t),t.hasEventListener(egret.TouchEvent.TOUCH_BEGIN)||t.addEventListener(egret.TouchEvent.TOUCH_BEGIN,t.touchBegin,t),t.hasEventListener(egret.TouchEvent.TOUCH_END)||t.addEventListener(egret.TouchEvent.TOUCH_END,t.touchEnd,t);var r=e.prototype.getData.call(this);null!=r&&(t.rarityObj=r,t.setCardInfo(t.rarityObj),t.setCurRightGroupShow(0))},t.prototype.sleep=function(){var e=this;e.hasEventListener(egret.TouchEvent.TOUCH_TAP)&&e.removeEventListener(egret.TouchEvent.TOUCH_TAP,e.touchTap,e),e.myCardView=null,e.cleanArray([e.cardSquareView]),e.cleanArray(e.arrSkillList),e.cardFetterInit&&(e.cardFetterInit=!1,e.cleanArray(e.arrFetterItemView)),e.cardShowInit&&(e.cardShowInit=!1,e.cleanArray([e.cardRectangleView])),e.cardAttrInit&&(e.cleanArrayLabel(e.arrAttrList),e.cleanArrayShape(e.arrAttrLine))},t.prototype.cleanArray=function(e){if(!(null==e||e.length<=0))for(var t=e.length-1;t>=0;t--){var r=e[t];if(null!=r){var a=r.parent;a.removeChild(r)}e.splice(t,1)}},t.prototype.cleanArrayLabel=function(e){if(!(null==e||e.length<=0))for(var t=e.length-1;t>=0;t--){var r=e[t];if(null!=r){var a=r.parent;a.removeChild(r)}e.splice(t,1)}},t.prototype.cleanArrayShape=function(e){if(!(null==e||e.length<=0))for(var t=e.length-1;t>=0;t--){var r=e[t];if(null!=r){var a=r.parent;a.removeChild(r)}e.splice(t,1)}},t.prototype.touchTap=function(e){var t=this;if(e.target instanceof eui.Button){var r=e.target;if(r==t.btnClose)t.hiden();else if(r==t.btnShow)this.setCurRightGroupShow(1);else if(r==t.btnFetter)this.setCurRightGroupShow(2);else if(r==t.btnSold)this.setCurRightGroupShow(3);else if(r==t.btnAttr)this.setCurRightGroupShow(0);else if(r==t.btnLvlUp)t.bagItemChoose=1,t.ImgChoose.x=t.btnUserItem0.x+3,t.ImgChoose.y=t.btnUserItem0.y+3,this.setCurRightGroupShow(4);else if(r==t.btnGeneUp)t.bagItemChoose=4,this.setCurRightGroupShow(5);else if(r==t.btnZhanshi)this.setCurRightGroupShow(1);else if(r==t.btnUserItem0)t.ImgChoose.x=r.x+3,t.ImgChoose.y=r.y+3,t.bagItemChoose=1;else if(r==t.btnUserItem1)t.ImgChoose.x=r.x+3,t.ImgChoose.y=r.y+3,t.bagItemChoose=2;else if(r==t.btnUserItem2)t.ImgChoose.x=r.x+3,t.ImgChoose.y=r.y+3,t.bagItemChoose=3;else if(r==t.btnUserItem){var a=this.upBagInfo["bag"+t.bagItemChoose];if(null==a)return;var n=a.bagId;new Object;this.upLvlByBag(1,n,a.shopKind)}else if(r==t.btnUseGeneItem){var a=this.upBagInfo.bag4,n=a.bagId;t.bagItemChoose=4,this.upLvlByBag(2,n,a.shopKind)}}},t.prototype.upLvlByBag=function(e,t,r){var a=new Object;a.type=e,a.bagId=t,a.code=this.code,a.shop_kind=r,a.itemIdx=this.bagItemChoose,a.usetype=!0;var n=GlobalDataManager.getInstance().getCenterServer();HttpManager.getInstance().send(n.getSname(),HallCmdDef.CMD_BaguseUp,a,!0)},t.prototype.touchBegin=function(e){if(e.target instanceof eui.Group){var t=e.target;if("groupSkill_"==t.name.substr(0,11)){var r=t.name.split("_");if(2!=r.length)return;var a=Number(r[1]),n=this.skillAry[a],o=this.skillOpenAry[a];null!=n&&(this.groupSkillExplain.visible=!0,this.groupSkillExplain.x=this.groupLeft.x+this.groupSkillList.x+this.arrSkillList[a].x+72,this.groupSkillExplain.y=this.groupLeft.y+this.groupSkillList.y+this.arrSkillList[a].y-12,this.labSkillName.text=n.sklName+" Lv. "+n.sklLvl,this.labSkillExplain.text=n.sklDesc,this.labeffect.text="无","1"==n.sklType?(this.labSkillType.text="主动技能",this.labSkillType.textColor=16518202):(this.labSkillType.text="被动技能",this.labSkillType.textColor=9294847),1==o?this.labLockState.text="解锁":this.labLockState.text="未解锁")}}},t.prototype.touchEnd=function(e){this.groupSkillExplain.visible=!1},t.prototype.setCardName=function(e){this.labCardName.text=e},t.prototype.setCardView=function(e){var t=this.myCardView;null==t&&(t=new CardSquareView),t.initData(e),t.scaleX=t.scaleY=this.groupCardView.width/t.width,this.groupCardView.addChild(t),t.x=0,t.y=0;var r=100*this.cardInfo.exp/this.upLvlInfo.allexp;this.prbLoading0.value=r},t.prototype.setimgGene=function(e){switch(e){case 1:this.imgGene.source="newcardpanel_json.daishu1";break;case 2:this.imgGene.source="newcardpanel_json.daishu2";break;case 3:this.imgGene.source="newcardpanel_json.daishu3"}},t.prototype.setgroupStar=function(e){e=this.levelnumTo5lvl(e),this.groupStar.removeChildren();for(var t=0;5>t;t++){var r=new eui.Image("newcardpanel_json.star0");this.groupStar.addChild(r),r.x=35*t,r.y=-23}for(var t=0;e>t;t++){var r=null;r=e-1>t?new eui.Image("newcardpanel_json.star1"):new eui.Image("newcardpanel_json.star2"),this.groupStar.addChild(r),r.x=35*t,r.y=-23}},t.prototype.setCardInfo=function(e){if(null!=e){var t=e.cardDetail;if(this.code=e.code,this.curCardView=e.viewhandle,null!=t){var r=t.attribute;null!=r&&this.setAttribute(r)}this.imgExpItem1.name="imgExpItem1",e.canTouch=!1,this.cardInfo=t.attribute,this.cardJBInfo=t.fetters,this.upLvlInfo=t.myupLvl,this.upBagInfo=t.mybag,this.setCardView(this.cardInfo),this.setCardName(this.cardInfo.name),this.setimgGene(this.cardInfo.generation),this.setgroupStar(this.cardInfo.level);var a=t.myskill;this.skillAry=[a.skil1,a.skil2,a.skil3,a.skil4];var n=t.skillopen;this.skillOpenAry=[n.skillopen_1,n.skillopen_2,n.skillopen_3,n.skillopen_4];for(var o=[],i=0;i<t.UnlockSkillConfig.length;i++){var l=t.UnlockSkillConfig[i],s=l.sklIndex;o[s]=l}this.unlockOpenAry=[o[1],o[2],o[3],o[4]],this.setCardSkill(this.skillAry,this.skillOpenAry,this.unlockOpenAry,this.cardInfo.level,this.cardInfo.generation),this.setGroupLvlUp(this.cardInfo),this.refreshUpBtns()}},t.prototype.refreshUpBtns=function(){return this.cardInfo.level>=15?(this.btnUserItem.enabled=!1,this.btnGeneUp.enabled=!1,this.btnLvlUp.enabled=!1,void(this.btnUseGeneItem.enabled=!1)):void(5*this.cardInfo.generation<=this.cardInfo.level?(this.btnUserItem.enabled=!1,this.btnGeneUp.enabled=!0,this.btnLvlUp.enabled=!1,this.btnUseGeneItem.enabled=!0):(this.btnUserItem.enabled=!0,this.btnGeneUp.enabled=!1,this.btnLvlUp.enabled=!0,this.btnUseGeneItem.enabled=!1))},t.prototype.setImgEXP=function(e,t){this.imgCurEXP.width=this.imgMaxEXP.width*e/t},t.prototype.setCardSkill=function(e,t,r,a,n){this.groupSkillList.removeChildren();for(var o=0,i=0;4>i;i++){var l={icon:"",rarity:"",canTouch:!0,groupName:"groupSkill_"+i};null!=e[i]&&(l={icon:e[i].iconUrl,rarity:e[i].sklLvl,canTouch:!0,groupName:"groupSkill_"+i});var s=new CardSkillView;if(s.initData(l),this.groupSkillList.addChild(s),this.arrSkillList[i]=s,o>1&&(o-=2),s.x=74*o,s.y=74*Math.floor(i/2),o++,null!=e[i]){var c=this.judjeSkillLock(i,a,n,r);if(0==t[i]){var p=new eui.Image;this.groupSkillList.addChild(p),p.source="newcardpanel_json.suo",p.$setScaleX(.8),p.$setScaleY(.8),p.x=s.x,p.y=s.y,p.touchEnabled=!1;var u=new eui.Label;this.groupSkillList.addChild(u),u.x=s.x+5,u.y=s.y,u.width=s.width-10,u.height=s.height,u.textAlign="center",u.verticalAlign="middle",u.lineSpacing=5,u.fontFamily="Microsoft YaHei",u.size=14,u.text=c,u.touchEnabled=!1}}else{var h=new eui.Image;this.groupSkillList.addChild(h),h.source="cardOperationSheet_json.b62x62_0",h.x=s.x,h.y=s.y}}},t.prototype.judjeSkillLock=function(e,t,r,a){var n="";switch(t=this.levelnumTo5lvl(t),e){case 0:n=a[0].gen+"代"+a[0].star+"星解锁";break;case 1:n=a[1].gen+"代"+a[1].star+"星解锁";break;case 2:n=a[2].gen+"代"+a[2].star+"星解锁";break;case 3:n=a[3].gen+"代"+a[3].star+"星解锁"}return n},t.prototype.recvData=function(e,t){var r=this;switch(e){case HallCmdDef.CMD_BaguseUp:var a=t.itemIdx,n=(t.bagId,t.msg);r.bagItemChoose=a,this.upBagInfo["bag"+r.bagItemChoose].shopNum=t.bagNum,this.cardInfo.exp=n.exp,this.upLvlInfo.allexp=t.allexp,this.cardInfo.generation=n.gen,this.cardInfo.level=n.level;var o=r.rarityObj.cardDetail,i=o.attribute;i.atk=n.atk,i.hp=n.hp,this.setAttribute(i),this.skillOpenAry=[n.open_1,n.open_2,n.open_3,n.open_4],this.setGroupLvlUp(this.cardInfo),this.setCardView(this.cardInfo),this.setgroupStar(this.cardInfo.level),this.setimgGene(this.cardInfo.generation),this.setCardSkill(this.skillAry,this.skillOpenAry,this.unlockOpenAry,this.cardInfo.level,this.cardInfo.generation);var l=this.curCardView;l.setLevel(this.cardInfo.level),l.setHp(this.cardInfo.hp),l.setAtk(this.cardInfo.atk),l.setGeneration(this.cardInfo.generation),this.refreshUpBtns()}},t.prototype.setAttribute=function(e){var t=e.rarity,r=GlobalDef.getInstance().getCardRarity(t),a=e.generation,n=this.levelnumTo5lvl(e.level),o=a+"代"+n+"星",i=e.atk,l=e.hit,s=e.hp,c=e.agl,p=e.att,u=e.cri_chance,h=e.cri_multiplier,d=e.rgn;this.setGroupAttrList({"品质":r,"星级":o,"战力":i+s,"等待回合":p,"生命":s,"攻击":i,"命中率":l,"闪避率":c,"暴击率":u,"暴击倍数":h,"回复":d})},t.prototype.setCurRightGroupShow=function(e){if(this.curBtnIndex!=e){switch(this.curBtnIndex=e,e){case 0:if(!this.cardAttrInit){this.cardInfo}break;case 1:this.setGroupShow();break;case 2:this.cardFetterInit||this.setGroupFetter();break;case 3:this.setGroupSold();break;case 4:break;case 5:this.setGroupGeneUp();break;case 6:this.setGroupGeneUp()}this.groupAttrList.visible=0==e,this.scrAttrListPanel.visible=0==e,this.scrAttrList.visible=0==e,this.groupShow.visible=1==e,this.groupFetter.visible=2==e,this.scrFetterPanel.visible=2==e,this.scrFetter.visible=2==e,this.groupSold.visible=3==e,this.groupShopPanel.visible=3==e,this.groupLvlUp.visible=4==e,this.groupGeneUp.visible=5==e,this.groupGeneUpPanel.visible=5==e,this.setChooseBtn(e)}},t.prototype.setChooseBtn=function(e){this.btnAttr.currentState=0==e?"down":"up",this.btnFetter.currentState=2==e?"down":"up",this.btnZhanshi.currentState=1==e?"down":"up",this.btnSold.currentState=3==e?"down":"up"},t.prototype.setGroupAttrList=function(e){this.cardAttrInit=!0;var t=0;this.cleanArrayLabel(this.arrAttrList),this.cleanArrayShape(this.arrAttrLine);for(var r in e){var a=t%2,n=new eui.Label;n.x=250*a+68,n.y=60*Math.floor(t/2)+42,n.textColor=16777215,n.textAlign="left",n.fontFamily="Microsoft YaHei",n.size=22,n.text=r+"：",this.groupAttrList.addChild(n);var o=new eui.Label;o.x=250*a+68+n.width,o.y=60*Math.floor(t/2)+42,o.textColor=16777215,o.textAlign="left",o.fontFamily="Microsoft YaHei",o.size=22,o.stroke=1,o.text=e[r],this.groupAttrList.addChild(o),this.arrAttrList.push(n),this.arrAttrList.push(o),t++}},t.prototype.setGroupShow=function(){this.cardShowInit=!0;var e=this.cardInfo,t=new CardRectangleView;t.initData(e),t.scaleX=1.34*this.groupCardShow.width/t.width,t.scaleY=1.34*this.groupCardShow.height/t.height,this.groupCardShow.addChild(t),this.groupCardShow.$setVisible(!0),t.x=-8,t.y=0,this.cardRectangleView=t},t.prototype.setGroupFetter=function(){this.cardFetterInit=!0;this.cardInfo;this.scrFetter.scrollPolicyH="OFF",this.cleanArray(this.arrFetterItemView);for(var e=(GlobalDataManager.getInstance().getJiBanData(),this.cardJBInfo),t=0;t<e.length;t++){var r=e[t],a=new CardFetterItemView,n={hero:this.cardInfo.name,name:r.name,desc:r.desc,icon:r.icon,zc:r.zc};a.initData(n),this.groupFetter.addChild(a),a.x=0,a.y=174*t,a.width=a.getViewWidth(),a.height=a.getViewHeight(),this.arrFetterItemView.push(a)}},t.prototype.setGroupGeneUp=function(){},t.prototype.levelnumTo5lvl=function(e){return(e-1)%5+1},t.prototype.setGroupLvlUp=function(e){this.lvUp_level.text=this.cardInfo.generation+"代"+this.levelnumTo5lvl(this.cardInfo.level)+"星",this.labExp.text=this.cardInfo.exp+"/"+this.upLvlInfo.allexp;for(var t=0;5>t;t++){var r=new eui.Image("newcardpanel_json.star1");this.groupLvlStar.addChild(r),r.x=t*r.width,r.y=0}this.btnUserItem0.imgItem.source="hallImg1Sheet_json.l1",this.btnUserItem1.imgItem.source="hallImg1Sheet_json.l2",this.btnUserItem2.imgItem.source="hallImg1Sheet_json.l8",this.BtnGeneUpItem.imgItem.source="hallImg1Sheet_json.l6",null!=this.upBagInfo.bag1&&(this.btnUserItem0.imgItem.source="hallImg1Sheet_json."+this.upBagInfo.bag1.resUrl,this.btnUserItem0.labItemNum.text=this.upBagInfo.bag1.shopNum,this.labExpItem1.text=this.upBagInfo.bag1.shopName),null!=this.upBagInfo.bag2&&(this.btnUserItem1.imgItem.source="hallImg1Sheet_json."+this.upBagInfo.bag2.resUrl,this.btnUserItem1.labItemNum.text=this.upBagInfo.bag2.shopNum,this.labExpItem2.text=this.upBagInfo.bag2.shopName),null!=this.upBagInfo.bag3&&(this.btnUserItem2.imgItem.source="hallImg1Sheet_json."+this.upBagInfo.bag3.resUrl,this.btnUserItem2.labItemNum.text=this.upBagInfo.bag3.shopNum,this.labExpItem3.text=this.upBagInfo.bag3.shopName),null!=this.upBagInfo.bag4&&(this.BtnGeneUpItem.imgItem.source="hallImg1Sheet_json."+this.upBagInfo.bag4.resUrl,this.BtnGeneUpItem.labItemNum.text=this.upBagInfo.bag4.shopNum,this.labGeneUpItem.text=this.upBagInfo.bag4.shopName)},t.prototype.setGroupSold=function(){},t.prototype.onResize=function(t){e.prototype.onResize.call(this,t);var r=this;if(null!=r.cardoperationgruop){var a=GlobalDef.SCREEN_WIDTH>GlobalDef.SCREEN_HEIGHT?GlobalDef.SCREEN_WIDTH:GlobalDef.SCREEN_HEIGHT,n=GlobalDef.SCREEN_WIDTH>GlobalDef.SCREEN_HEIGHT?GlobalDef.SCREEN_HEIGHT:GlobalDef.SCREEN_WIDTH,o=r.$stage.stageWidth,i=r.$stage.stageHeight,l=Number((o/i/(a/n)).toFixed(2));return l>1||0>l?void(r.cardoperationgruop.scaleX=r.cardoperationgruop.scaleY=1):void(r.cardoperationgruop.scaleX=r.cardoperationgruop.scaleY=l)}},t.NAME="CardOperationSkin",t}(BaseView);__reflect(CardOperationView.prototype,"CardOperationView");var CardView=function(e){function t(){var r=e.call(this,t.NAME)||this;return r.arrOptionBtn=new Array,r.curChooseOptionBtnIndex=-1,r.arrCardItem=new Array,r.arrCardInfo=new Array,r.arrRCardPosX=new Array,r.bRCardScale=.54,r.cRCardScale=.35,r.sortText=[["战力由高到低","战力由低到高","攻击由高到低","攻击由低到高","生命由高到低","生命由低到高","费用由高到低","费用由低到高"],["全品质","普通","稀有","史诗","传奇","神话"],["全五行","金","木","水","火","土"]],r.arrSort1=["战力由高到低","战力由低到高","攻击由高到低","攻击由低到高","生命由高到低","生命由低到高","费用由低到高","费用由高到低"],r.arrSort2=["全品质","普通","稀有","史诗","传奇","神话"],r.arrSort3=["全五行","金","木","水","火","土"],r.sortFactor={sort:0,rarity:0,element:0},r.pageNum=1,r.pageSize=20,r.receiveNum=0,r.sortList=["combat desc","combat asc","atk desc","atk asc","hp desc","hp asc","cost desc","cost desc"],r.leftStatus=0,r.needUp=!1,r.hIndex=0,r.vIndex=0,r.mallName=[],r.cardConfigList=[],r.movingState=!1,r.arrRCardItem=new Array,r}return __extends(t,e),t.prototype.week=function(){var e=this;e.hasEventListener(egret.TouchEvent.TOUCH_TAP)||e.addEventListener(egret.TouchEvent.TOUCH_TAP,e.touchTap,e),e.scrCardItem.addEventListener(eui.UIEvent.CHANGE,e.moveHandler,e),e.scrCardItem.addEventListener(eui.UIEvent.CHANGE_END,e.outHandler,e),e.scrCardItem.addEventListener(egret.TouchEvent.TOUCH_CANCEL,e.onCancelHandler,e),e.scrCardItem.addEventListener(egret.TouchEvent.TOUCH_END,e.onEndHandler,e),this.pageNum=1,this.needUp=!1,this.receiveNum=0,e.sortFactor.sort=0,e.sortFactor.rarity=0,e.sortFactor.element=0,this.mallName=[],e.setOptionBtn(),e.sendGetCardList()},t.prototype.onCancelHandler=function(){this.movingState=!0},t.prototype.onEndHandler=function(){this.movingState=!1},t.prototype.sleep=function(){var e=this;e.cleanArray(e.arrOptionBtn),e.cleanArray(e.arrCardItem),e.hIndex=0,e.vIndex=0,e.scrCardItem.viewport.scrollH=0,e.scrCardItem.viewport.scrollV=0},t.prototype.cleanArray=function(e){if(!(null==e||e.length<=0))for(var t=e.length-1;t>=0;t--){var r=e[t];if(null!=r){var a=r.parent;a.removeChild(r)}e.splice(t,1)}},t.prototype.recvData=function(e,t){var r=this;switch(e){case HallCmdDef.CMD_CardWiewLists:var a=t.length;this.receiveNum=a;for(var n=0;a>n;n++){var o=t[n],i=(this.pageNum-1)*this.pageSize+n;r.mallName[i]=o}r.setCardItem(r.mallName),a>0&&(this.pageNum=this.pageNum+1),UIManager.getInstance().hideUI(CGPSortView);break;case HallCmdDef.CMD_GET_CARD_DETAIL:r.addCardDetail(t)}},t.prototype.addCardDetail=function(e){var t=e;t.viewhandle=this.curCardView,UIManager.getInstance().showUI(CardOperationView,GameScene.VIEW_LAYER_NUMBER,-1,0,0,0,e)},t.prototype.touchTap=function(e){var t=this;if(e.target instanceof eui.Button){var r=e.target;if("btnOption_"==r.name.substr(0,10)){var a=r.name.split("_");if(2!=a.length)return;var n=Number(a[1]);if(0==n){var o={desArr:t.arrSort1,cbHandler:Handler.create(t,t.onChooseCardSort1),selIndex:t.sortFactor.sort};UIManager.getInstance().showUI(CGPSortView,GameScene.VIEW_LAYER_NUMBER,-1,0,0,0,o)}else if(1==n){var o={desArr:t.arrSort2,cbHandler:Handler.create(t,t.onChooseCardSort2),selIndex:t.sortFactor.rarity};UIManager.getInstance().showUI(CGPSortView,GameScene.VIEW_LAYER_NUMBER,-1,0,0,0,o)}else if(2==n){var o={desArr:t.arrSort3,cbHandler:Handler.create(t,t.onChooseCardSort3),selIndex:t.sortFactor.element};UIManager.getInstance().showUI(CGPSortView,GameScene.VIEW_LAYER_NUMBER,-1,0,0,0,o)}}else if("btnOptionItem_"==r.name.substr(0,14)){var a=r.name.split("_");if(3!=a.length)return;var i=Number(a[1]),l=Number(a[2]);t.setCurChooseOptionBtnItemByIndex(i,l),t.arrOptionBtn[i].hiddenGroupItem(),t.arrOptionBtn[i].setBtnContent(t.sortText[i][l]),t.scrOptionBtn.viewport.scrollH=0,t.scrOptionBtn.viewport.scrollV=0,t.setEnable(!0),t.updateOptionBtnPos(),t.cleanArray(t.arrCardItem),t.hIndex=0,t.vIndex=0,t.scrCardItem.viewport.scrollH=0,t.scrCardItem.viewport.scrollV=0,t.addNewData()}else r==t.btnBack&&t.hiden()}else if(e.target instanceof eui.Group){var s=e.target;if("groupCR_"==s.name.substr(0,8)){if(t.movingState)return;var a=s.name.split("_");if(2!=a.length)return;var n=Number(a[1]);t.onClickSCardItem(n)}}},t.prototype.onClickSCardItem=function(e){var t=this.arrCardInfo[e];this.curCardView=this.arrCardItem[e];var r=t.code;this.showCardDetailView(r)},t.prototype.showCardDetailView=function(e){if(null!=e&&""!=e){var t=GlobalDataManager.getInstance().getCenterServer(),r={code:e};HttpManager.getInstance().send(t.getSname(),HallCmdDef.CMD_GET_CARD_DETAIL,r)}},t.prototype.onChooseCardSort1=function(e){this.onChangeCardSort(1,e)},t.prototype.onChooseCardSort2=function(e){this.onChangeCardSort(2,e)},t.prototype.onChooseCardSort3=function(e){this.onChangeCardSort(3,e)},t.prototype.onChangeCardSort=function(e,t){var r=this;if(null!=r.sortFactor){var a="";a=1==e?"sort":2==e?"rarity":"element";var n=r.sortFactor[a],o=!0;(null==n||n==t)&&(o=!1),this.arrOptionBtn[e-1].setBtnContent(this.sortText[e-1][t]),o?(r.sortFactor[a]=t,r.pageNum=1,r.mallName=[],r.sendGetCardList()):UIManager.getInstance().hideUI(CGPSortView)}},t.prototype.sendGetCardList=function(){var e=GlobalDataManager.getInstance().getCenterServer(),t=this,r={rarity:t.sortFactor.rarity,element:t.sortFactor.element,sort:t.sortFactor.sort,pageNum:t.pageNum,pageSize:t.pageSize};HttpManager.getInstance().send(e.getSname(),HallCmdDef.CMD_CardWiewLists,r)},t.prototype.moveHandler=function(e){this.scrCardItem.viewport.scrollV>this.scrCardItem.viewport.contentHeight-this.scrCardItem.viewport.height-40&&(this.needUp=!0)},t.prototype.outHandler=function(e){this.receiveNum<this.pageSize&&(this.needUp=!1),this.needUp&&(this.needUp=!1,this.addNewData())},t.prototype.addNewData=function(){this.sendGetCardList()},t.prototype.setEnable=function(e){for(var t=0;t<this.arrOptionBtn.length;t++)this.arrOptionBtn[t].setBtnOptionEnable(e)},t.prototype.setOptionBtn=function(){for(var e=this,t=["排序","全品质","全五行"],r=0;r<e.sortText.length;r++){var a=new OptionBtnView;a.init(),e.groupOptionBtn.addChild(a),a.setBtnContent(t[r]),a.setBtnName("btnOption_"+r),a.x=0,e.arrOptionBtn.push(a);for(var n=0,o=0;o<e.sortText[r].length;o++){var i=new OptionBtnItemView;i.init(),a.addItem(i),i.setBtnContent(e.sortText[r][o]),i.x=0,i.y=n,i.width=i.getViewWidth(),i.height=i.getViewHeight(),i.setBtnName("btnOptionItem_"+r+"_"+o),n+=i.getViewHeight()}a.setItemGroupHeight(n),a.hiddenGroupItem(),a.width=a.getViewWidth(),a.height=a.getViewHeight()}e.updateOptionBtnPos()},t.prototype.setCurChooseOptionBtnByIndex=function(e){var t=this,r=null;if(null!=t.curChooseOptionBtnIndex&&-1!=t.curChooseOptionBtnIndex){if(r=t.getOptionBtnViewByIndex(t.curChooseOptionBtnIndex),null==r)return;if(r.setCurChoose(),t.curChooseOptionBtnIndex==e)return}t.curChooseOptionBtnIndex=e,r=t.getOptionBtnViewByIndex(e),null!=r&&(r.setCurChoose(1),t.updateOptionBtnPos())},t.prototype.setCurChooseOptionBtnItemByIndex=function(e,t){var r=this,r=this,a=null;if(null!=r.curChooseOptionBtnIndex&&-1!=r.curChooseOptionBtnIndex&&r.curChooseOptionBtnIndex!=e){if(a=r.getOptionBtnViewByIndex(r.curChooseOptionBtnIndex),null==a)return;a.setCurChoose()}r.curChooseOptionBtnIndex=e,a=r.getOptionBtnViewByIndex(e),null!=a&&(a.setCurChoose(1),a.setItemChooseState(t),r.updateOptionBtnPos())},t.prototype.getOptionBtnViewByIndex=function(e){for(var t=null,r=this,a=0,n=r.arrOptionBtn.length;n>a;a++){var o=r.arrOptionBtn[a];if(null!=o){var i=o.getBtnName(),l=i.split("_");if(2==l.length){var s=Number(l[1]);if(e==s){t=o;break}}}}return t},t.prototype.updateOptionBtnPos=function(){for(var e=this,t=0,r=0,a=e.arrOptionBtn.length;a>r;r++){var n=e.arrOptionBtn[r];null!=n&&(n.y=t,n.height=n.getViewHeight(),t+=n.getViewHeight()+10)}},t.prototype.removeRCardItem=function(){for(var e=this;e.arrRCardPosX.length;)e.arrRCardPosX.pop();for(;e.arrCardInfo.length;)e.arrCardInfo.pop();e.cleanArray(e.arrCardItem),e.groupCardItem.removeChildren(),e.groupCardItem.scrollV=0,e.hIndex=0,e.vIndex=0},t.prototype.setCardItem=function(e){var t=this;t.pageNum<=1&&t.removeRCardItem();for(var r=5,a=t.scrCardItem.width/r,n=7,o=1,i=t.arrCardItem.length,l=e.length-i,s=0;l>s;s++){var c=i+s,p=e[c];if(null!=p){var u=new CardSquareView,h=this.toFormatObject(p,c);u.initData(h),u.scaleX=u.scaleY=1,t.groupCardItem.addChild(u);var d=a*t.hIndex;u.x=d,u.y=t.vIndex*(u.height+10),t.arrCardInfo.push(h),t.arrCardItem.push(u),t.arrRCardPosX.push(d),t.hIndex++,t.hIndex>=r&&(t.hIndex=0,t.vIndex++),o=o>=n?1:++o}}},t.prototype.toFormatObject=function(e,t){var r={icon:e.iconUrl,rarity:e.rarity,element:e.ele,round:e.round,generation:e.gen,name:e.name,cost:e.cst,level:(e.level-1)%5+1,atk:e.atk,hp:e.hp,agl:e.agl,hit:e.hit,att:e.att,code:e.code,cri_chance:1,cri_multiplier:1,rgn:e.rgn,jblist:1,groupName:"groupCR_"+t,canTouch:!0};return r},t.prototype.onResize=function(t){e.prototype.onResize.call(this,t);var r=this;if(null!=r.cardskingroup){var a=GlobalDef.SCREEN_WIDTH>GlobalDef.SCREEN_HEIGHT?GlobalDef.SCREEN_WIDTH:GlobalDef.SCREEN_HEIGHT,n=GlobalDef.SCREEN_WIDTH>GlobalDef.SCREEN_HEIGHT?GlobalDef.SCREEN_HEIGHT:GlobalDef.SCREEN_WIDTH,o=r.$stage.stageWidth,i=r.$stage.stageHeight,l=Number((o/i/(a/n)).toFixed(2));return l>1||0>l?void(r.cardskingroup.scaleX=r.cardskingroup.scaleY=1):void(r.cardskingroup.scaleX=r.cardskingroup.scaleY=l)}},t.NAME="CardSkin",t}(BaseView);__reflect(CardView.prototype,"CardView");var CombatRecordView=function(e){function t(){var r=e.call(this,t.NAME)||this;return r.arrRecordBtn=new Array,r.arrCardHeadView=new Array,r.arrCardFetters=new Array,r.arrCircle=new Array,r.needUp=!1,r.mallName=[],r.jbList=[],r.pageId=0,r.pageSize=8,r}return __extends(t,e),t.prototype.week=function(){var e=this;e.hasEventListener(egret.TouchEvent.TOUCH_TAP)||e.addEventListener(egret.TouchEvent.TOUCH_TAP,e.touchTap,e),e.scrRecordBtn.addEventListener(eui.UIEvent.CHANGE,e.moveHandler,e),e.scrRecordBtn.addEventListener(eui.UIEvent.CHANGE_END,e.outHandler,e),e.initView(!1),e.sendGetRecordList()},t.prototype.initView=function(e){this.groupDetails.$setVisible(e)},t.prototype.sendGetRecordList=function(){var e=GlobalDataManager.getInstance().getAccountData(),t=e.uname,r={ratity:t,pageid:1,pageSize:8},a=GlobalDataManager.getInstance().getCenterServer();HttpManager.getInstance().send(a.getSname(),HallCmdDef.CMD_Record,r,!0)},t.prototype.sleep=function(){this.cleanArray(this.arrRecordBtn),this.cleanRecord()},t.prototype.cleanRecord=function(){this.cleanArray(this.arrCardHeadView),this.cleanArrayLabel(this.arrCardFetters),this.cleanArrayShape(this.arrCircle)},t.prototype.cleanArray=function(e){if(!(null==e||e.length<=0))for(var t=e.length-1;t>=0;t--){var r=e[t];if(null!=r){var a=r.parent;a.removeChild(r)}e.splice(t,1)}},t.prototype.cleanArrayLabel=function(e){if(!(null==e||e.length<=0))for(var t=e.length-1;t>=0;t--){var r=e[t];if(null!=r){var a=r.parent;a.removeChild(r)}e.splice(t,1)}},t.prototype.cleanArrayShape=function(e){if(!(null==e||e.length<=0))for(var t=e.length-1;t>=0;t--){var r=e[t];if(null!=r){var a=r.parent;a.removeChild(r)}e.splice(t,1)}},t.prototype.recvData=function(e,t){var r=this;switch(e){case HallCmdDef.CMD_Record:r.pageId=parseInt(t.pageId);for(var a=t.msg.length,n=0;a>n;n++){var o=t.msg[n];r.mallName[n+(r.pageId-1)*this.pageSize]=o}for(var i=t.jbconfig.length,n=0;i>n;n++){var o=t.jbconfig[n],l=t.jbconfig[n].code;r.jbList[l]=o}a>0&&(r.initView(!0),this.setRecordBtn(),r.setDetails(0))}},t.prototype.touchTap=function(e){var t=this;if(e.target instanceof eui.Button){var r=e.target;if("btnRecord_"==r.name.substr(0,10)){var a=r.name.split("_");if(2!=a.length)return;var n=Number(a[1]);t.setCurChooseOptionBtnByIndex(n),t.cleanRecord(),t.setDetails(n)}else r==t.btnBack&&t.hiden()}},t.prototype.moveHandler=function(e){this.scrRecordBtn.viewport.scrollV>this.scrRecordBtn.viewport.contentHeight-this.scrRecordBtn.viewport.height-40&&(this.needUp=!0)},t.prototype.outHandler=function(e){if(this.needUp){this.needUp=!1;var t=GlobalDataManager.getInstance().getAccountData(),r=t.uname,a={ratity:r,pageid:this.pageId+1,pageSize:this.pageSize},n=GlobalDataManager.getInstance().getCenterServer();HttpManager.getInstance().send(n.getSname(),HallCmdDef.CMD_Record,a,!1)}},t.prototype.addRecord=function(){this.setRecordBtn()},t.prototype.getDate=function(e){var t=e,r=t.split(" "),a=r[0].split("-"),n=r[1].split(":"),o=new Date(parseInt(a[0]),parseInt(a[1])-1,parseInt(a[2]),parseInt(n[0]),parseInt(n[1]),parseInt(n[2]));return o},t.prototype.add0=function(e,t){return(Array(t).join("0")+e).slice(-t)},t.prototype.setRecordBtn=function(){for(var e=this,t=e.mallName.length,r=e.arrRecordBtn.length,a=0;t-r>a;a++){var n=new RecordBtnView;n.init(),e.groupRecordBtn.addChild(n);var o=e.mallName[a].createDate,i=new Date(o),l=this.add0(i.getMinutes().toString(),2),s=this.add0(i.getHours().toString(),2),c=this.add0(i.getMonth(),2),p=this.add0(i.getDay(),2);n.setBtnTmContent(s+":"+l+"  "+c+"-"+p),e.mallName[a+r].resultNum>0?(n.setBtnScoreContent("+"+e.mallName[a+r].resultNum),n.setBtnRewardImg(0)):(n.setBtnScoreContent(""+e.mallName[a+r].resultNum),n.setBtnRewardImg(1)),n.setBtnName("btnRecord_"+(a+r)),n.x=-2,n.width=n.getViewWidth(),n.height=n.getViewHeight(),n.y=n.getViewHeight()*a,e.arrRecordBtn.push(n)}e.updateOptionBtnPos(),e.setCurChooseOptionBtnByIndex(0)},t.prototype.setCurChooseOptionBtnByIndex=function(e){var t=this,r=null;if(null!=t.curChooseRecordBtnIndex&&-1!=t.curChooseRecordBtnIndex){if(r=t.getOptionBtnViewByIndex(t.curChooseRecordBtnIndex),null==r)return;
if(r.setCurChoose(),t.curChooseRecordBtnIndex==e)return void(t.curChooseRecordBtnIndex=-1)}t.curChooseRecordBtnIndex=e,r=t.getOptionBtnViewByIndex(e),null!=r&&(r.setCurChoose(1),t.updateOptionBtnPos())},t.prototype.getOptionBtnViewByIndex=function(e){for(var t=null,r=this,a=0,n=r.arrRecordBtn.length;n>a;a++){var o=r.arrRecordBtn[a];if(null!=o){var i=o.getBtnName(),l=i.split("_");if(2==l.length){var s=Number(l[1]);if(e==s){t=o;break}}}}return t},t.prototype.updateOptionBtnPos=function(){for(var e=this,t=0,r=0,a=e.arrRecordBtn.length;a>r;r++){var n=e.arrRecordBtn[r];null!=n&&(n.y=t+5,t+=n.getViewHeight()+10)}},t.prototype.setCombatResult=function(e){if(0==e){this.imgLeftBG.source="combatRecordSheet_json.a60x78_0",this.imgLeftRes.source="combatRecordSheet_json.a54x58_1",this.imgRightBG.source="combatRecordSheet_json.a60x78_1",this.imgRightRes.source="combatRecordSheet_json.a54x58_0";var t=new egret.Shape;this.groupLeftHeadFrame.addChild(t),t.graphics.lineStyle(2,4032503),t.graphics.drawCircle(39,39,35);var r=new egret.Shape;this.groupRightHeadFrame.addChild(r),r.graphics.lineStyle(2,11995439),r.graphics.drawCircle(39,39,35),this.arrCircle.push(t),this.arrCircle.push(r)}else{this.imgLeftBG.source="combatRecordSheet_json.a60x78_1",this.imgLeftRes.source="combatRecordSheet_json.a54x58_0",this.imgRightBG.source="combatRecordSheet_json.a60x78_0",this.imgRightRes.source="combatRecordSheet_json.a54x58_1";var t=new egret.Shape;this.groupLeftHeadFrame.addChild(t),t.graphics.lineStyle(2,11995439),t.graphics.drawCircle(39,39,35);var r=new egret.Shape;this.groupRightHeadFrame.addChild(r),r.graphics.lineStyle(2,4032503),r.graphics.drawCircle(39,39,35),this.arrCircle.push(t),this.arrCircle.push(r)}},t.prototype.setLeftName=function(e){this.labLeftName.text=e},t.prototype.setRightName=function(e){this.labRightName.text=e},t.prototype.setLeftHead=function(e){this.imgLeftHead.source=e},t.prototype.setRightHead=function(e){this.imgRightHead.source=e},t.prototype.setLeftCombat=function(e){this.labLeftCombat.text=""+e},t.prototype.setRightCombat=function(e){this.labRightCombat.text=""+e},t.prototype.setRecordId=function(e){this.labRecordId.text="对战ID:"+e},t.prototype.setLeftFetters=function(e){for(var t=0;t<e.length;t++){var r=new eui.Label;this.groupleftFetters.addChild(r),r.text=e[t],r.x=0,r.y=25*t,r.width=420,r.height=25,r.textAlign="left",r.verticalAlign="middle",r.size=20,r.fontFamily="Microsoft YaHei",this.arrCardFetters.push(r)}},t.prototype.setRightFetters=function(e){for(var t=0;t<e.length;t++){var r=new eui.Label;this.groupRightFetters.addChild(r),r.text=e[t],r.x=0,r.y=25*t,r.width=420,r.height=25,r.textAlign="left",r.verticalAlign="middle",r.size=20,r.fontFamily="Microsoft YaHei",this.arrCardFetters.push(r)}},t.prototype.setLeftCardHeads=function(e){for(var t=this.mallName[e].winCards,r=t.split("|"),a=r.length,n=0;a>n;n++){var t=r[n],o=t.split(","),i={icon:o[0],name:o[1],rarity:o[2],element:o[3],generation:o[4],level:this.levelnumTo5lvl(parseInt(o[5])),combat:o[6]},l=new CardHeadView;l.initData(i),this.groupLeftCardHeads.addChild(l),this.arrCardHeadView.push(l),5>n?(l.x=n*this.groupLeftCardHeads.width/5,l.y=0):(l.x=(n-5)*this.groupLeftCardHeads.width/5,l.y=160)}},t.prototype.levelnumTo5lvl=function(e){return(e-1)%5+1},t.prototype.setRightCardHeads=function(e){for(var t=this.mallName[e].loseCards,r=t.split("|"),a=r.length,n=0;a>n;n++){var t=r[n],o=t.split(","),i={icon:o[0],name:o[1],rarity:o[2],element:o[3],generation:o[4],level:this.levelnumTo5lvl(parseInt(o[5])),combat:o[6]},l=new CardHeadView;l.initData(i),this.groupRightCardHeads.addChild(l),this.arrCardHeadView.push(l),5>n?(l.x=n*this.groupRightCardHeads.width/5,l.y=0):(l.x=(n-5)*this.groupRightCardHeads.width/5,l.y=160)}},t.prototype.setDetails=function(e){var t=this,r=e;t.setCombatResult(1),t.setLeftName(t.mallName[r].winName),t.setRightName(t.mallName[r].loseName),t.setLeftHead("headImg0Sheet_json.chengpu"),t.setRightHead("headImg0Sheet_json.chengpu"),t.setLeftCombat(t.mallName[r].winCap),t.setRightCombat(t.mallName[r].loseCap),t.setRecordId(t.mallName[r].settId),t.setLeftCardHeads(r),t.setRightCardHeads(r);for(var a=t.mallName[r].winJbid,n=a.split(","),o=[],i=0;i<n.length;i++){var l="0";parseInt(n[i])>0&&(l="SKL1"+this.add0(n[i],7),o.push(t.jbList[l].name+" : "+t.jbList[l].fetDesc))}o.length>0&&t.setLeftFetters(o),n=[],o=[];var s=t.mallName[r].loseJbid;n=s.split(",");for(var i=0;i<n.length;i++){var l="0";parseInt(n[i])>0&&(l="SKL1"+this.add0(n[i],7),o.push(t.jbList[l].name+" : "+t.jbList[l].fetDesc))}o.length>0&&t.setRightFetters(o)},t.prototype.onResize=function(t){e.prototype.onResize.call(this,t);var r=this;if(null!=r.recordskingroup){var a=GlobalDef.SCREEN_WIDTH>GlobalDef.SCREEN_HEIGHT?GlobalDef.SCREEN_WIDTH:GlobalDef.SCREEN_HEIGHT,n=GlobalDef.SCREEN_WIDTH>GlobalDef.SCREEN_HEIGHT?GlobalDef.SCREEN_HEIGHT:GlobalDef.SCREEN_WIDTH,o=r.$stage.stageWidth,i=r.$stage.stageHeight,l=Number((o/i/(a/n)).toFixed(2));return l>1||0>l?void(r.recordskingroup.scaleX=r.recordskingroup.scaleY=1):void(r.recordskingroup.scaleX=r.recordskingroup.scaleY=l)}},t.NAME="CombatRecordSkin",t}(BaseView);__reflect(CombatRecordView.prototype,"CombatRecordView");var FettersView=function(e){function t(){var r=e.call(this,t.NAME)||this;return r.arrCardFetters=new Array,r.nameList=new Array,r}return __extends(t,e),t.prototype.week=function(){var e=this;this.infoPanel.visible=!1,e.hasEventListener(egret.TouchEvent.TOUCH_BEGIN)||e.addEventListener(egret.TouchEvent.TOUCH_BEGIN,e.touchBegin,e),e.hasEventListener(egret.TouchEvent.TOUCH_END)||e.addEventListener(egret.TouchEvent.TOUCH_END,e.touchEnd,e),e.sendGetFettersList()},t.prototype.sendGetFettersList=function(){var e=GlobalDataManager.getInstance().getCenterServer();HttpManager.getInstance().send(e.getSname(),HallCmdDef.CMD_GET_FETTERS_CONFIG,{},!0)},t.prototype.recvData=function(e,t){var r=this;switch(e){case HallCmdDef.CMD_GET_FETTERS_CONFIG:for(var a=t.length,n=0;a>n;n++){var o=t[n],i=o.fetId;this.nameList[i-1]=o}r.setCardFetters()}},t.prototype.sleep=function(){this.cleanArray(this.arrCardFetters)},t.prototype.cleanArray=function(e){if(!(null==e||e.length<=0))for(var t=e.length-1;t>=0;t--){var r=e[t];if(null!=r){var a=r.parent;a.removeChild(r)}e.splice(t,1)}},t.prototype.setCardFetters=function(){for(var e=this,t=9,r=e.JibanBtnGroup.width/t,a=e.JibanBtnGroup.height/4,n=0,o=0,i=this.nameList.length,l=0;3>l;l++)for(var s=0;t>s;s++){if(l*t+s+1>21)return;var c=this.nameList[l*t+s],p={icon:c.icon,canTouch:!0,visible:i>s,name:(l*t+s+1).toString()},u=new CardFetterView;u.initData(p),e.JibanBtnGroup.addChild(u);var h=1;u.scaleX=u.scaleY=h,u.x=o*r+r/4-40,u.y=n*a+30,e.arrCardFetters.push(u),o++,o>=t&&(o=0,n++)}},t.prototype.touchEnd=function(e){var t=this,r=e.target;if(r instanceof eui.Button)if(r==t.PanelButton)this.infoPanel.visible=!1;else{e.stageX,e.stageY;this.infoPanel.visible=!0;var a=Number(r.name),n=this.nameList.length;if(0>=a)return;n>=a?(this.xiaoguo1.text=this.nameList[a-1].name+":"+this.nameList[a-1].fetDesc,this.xiaoguo2.text="",this.jiban1.text=this.nameList[a-1].fetZc,this.jiban2.text=""):(this.xiaoguo1.text="暂无数据",this.xiaoguo2.text="暂无数据",this.jiban1.text="暂无数据",this.jiban2.text="暂无数据")}},t.prototype.touchBegin=function(e){var t=this,r=e.target;r instanceof eui.Button&&r==t.btnBack&&t.hiden()},t.prototype.onResize=function(t){e.prototype.onResize.call(this,t);var r=this;if(null!=r.jibanskingruop){var a=GlobalDef.SCREEN_WIDTH>GlobalDef.SCREEN_HEIGHT?GlobalDef.SCREEN_WIDTH:GlobalDef.SCREEN_HEIGHT,n=GlobalDef.SCREEN_WIDTH>GlobalDef.SCREEN_HEIGHT?GlobalDef.SCREEN_HEIGHT:GlobalDef.SCREEN_WIDTH,o=r.$stage.stageWidth,i=r.$stage.stageHeight,l=Number((o/i/(a/n)).toFixed(2));return l>1||0>l?void(r.jibanskingruop.scaleX=r.jibanskingruop.scaleY=1):void(r.jibanskingruop.scaleX=r.jibanskingruop.scaleY=l)}},t.NAME="JiBanSkin",t}(BaseView);__reflect(FettersView.prototype,"FettersView");var OptionBtnItemView=function(e){function t(){var r=e.call(this,t.NAME)||this;return r.curChooseState=0,r}return __extends(t,e),t.prototype.week=function(){var e=this;e.lblDesNColor=10252099,e.lblDesStrokeNColor=1250075,e.lblDesCColor=15334655,e.lblDesStrokeCColor=12122111,e.setCurChoose()},t.prototype.sleep=function(){},t.prototype.getViewWidth=function(){return this.groupOIB.width},t.prototype.getViewHeight=function(){return this.groupOIB.height},t.prototype.setBtnContent=function(e){this.lblDes.text=e},t.prototype.getBtnContent=function(){return this.lblDes.text},t.prototype.setBtnName=function(e){this.btnOptionItem.name=e},t.prototype.getBtnName=function(){return this.btnOptionItem.name},t.prototype.setCurChoose=function(e,t){void 0===e&&(e=0),void 0===t&&(t=!1);var r=this;r.curChooseState!=e&&(r.curChooseState=e,t&&(r.btnOptionItem.touchEnabled=0==e),r.imgChooseState.visible=1==e,r.lblDes.textColor=0==e?r.lblDesNColor:r.lblDesCColor,r.lblDes.strokeColor=0==e?r.lblDesStrokeNColor:r.lblDesStrokeCColor)},t.prototype.getCurChooseState=function(){return this.curChooseState},t.NAME="OptionBtnItemSkin",t}(BaseView);__reflect(OptionBtnItemView.prototype,"OptionBtnItemView");var OptionBtnView=function(e){function t(){var r=e.call(this,t.NAME)||this;return r.curChooseState=0,r.arrOptionBtnItem=new Array,r.ItemGroupHeight=0,r}return __extends(t,e),t.prototype.week=function(){var e=this;e.lblDesNColor=12300217,e.lblDesStrokeNColor=1250075,e.lblDesCColor=16776417,e.lblDesStrokeCColor=16763174,e.setCurChoose()},t.prototype.sleep=function(){var e=this;e.cleanArray(e.arrOptionBtnItem)},t.prototype.cleanArray=function(e){if(!(null==e||e.length<=0))for(var t=e.length-1;t>=0;t--){var r=e[t];if(null!=r){var a=r.parent;a.removeChild(r)}e.splice(t,1)}},t.prototype.getViewWidth=function(){return this.groupOB.width},t.prototype.getViewHeight=function(){var e=this,t=e.groupOB.height+e.groupItem.height;return t},t.prototype.setBtnContent=function(e){this.lblDes.text=e},t.prototype.getBtnContent=function(){return this.lblDes.text},t.prototype.setBtnName=function(e){this.btnOption.name=e},t.prototype.getBtnName=function(){return this.btnOption.name},t.prototype.setItemGroupHeight=function(e){this.ItemGroupHeight=e},t.prototype.setCurChoose=function(e,t){void 0===e&&(e=0),void 0===t&&(t=!1);var r=this;if(r.curChooseState!=e&&(r.curChooseState=e,r.lblDes.textColor=0==e?r.lblDesNColor:r.lblDesCColor,r.lblDes.strokeColor=0==e?r.lblDesStrokeNColor:r.lblDesStrokeCColor,t&&(r.btnOption.touchEnabled=0==e),r.imgChooseState.visible=1==e,0==e&&null!=r.curChooseOptionBtnItemIndex)){var a=r.getOptionBtnItemViewByIndex(r.curChooseOptionBtnItemIndex);if(null==a)return;a.setCurChoose(),r.curChooseOptionBtnItemIndex=-1}},t.prototype.getCurChooseState=function(){return this.curChooseState},t.prototype.getCurChooseOptionBtnItemIndex=function(){return this.curChooseOptionBtnItemIndex},t.prototype.addItem=function(e){var t=this;t.arrOptionBtnItem.push(e),t.groupItem.addChild(e)},t.prototype.setItemChooseState=function(e,t){void 0===t&&(t=!1);var r=this,a=null;if(null!=r.curChooseOptionBtnItemIndex&&-1!=r.curChooseOptionBtnItemIndex){if(a=r.getOptionBtnItemViewByIndex(r.curChooseOptionBtnItemIndex),null==a)return;if(a.setCurChoose(0,t),r.curChooseOptionBtnItemIndex==e)return void(r.curChooseOptionBtnItemIndex=-1)}r.curChooseOptionBtnItemIndex=e,a=r.getOptionBtnItemViewByIndex(e),null!=a&&a.setCurChoose(1,t)},t.prototype.getOptionBtnItemViewByIndex=function(e){var t=this;if(0>e||e>=t.arrOptionBtnItem.length)return null;for(var r=null,a=0,n=t.arrOptionBtnItem.length;n>a;a++){var o=t.arrOptionBtnItem[a];if(null!=o){var i=o.getBtnName(),l=i.split("_");if(3==l.length){var s=Number(l[2]);if(e==s){r=o;break}}}}return r},t.prototype.hiddenGroupItem=function(){this.groupItem.height=0,this.groupItem.visible=!1},t.prototype.showGroupItem=function(){this.groupItem.height=this.ItemGroupHeight,this.groupItem.visible=!0},t.prototype.setBtnOptionEnable=function(e){this.btnOption.enabled=e},t.NAME="OptionBtnSkin",t}(BaseView);__reflect(OptionBtnView.prototype,"OptionBtnView");var RecordBtnView=function(e){function t(){var r=e.call(this,t.NAME)||this;return r.curChooseState=0,r}return __extends(t,e),t.prototype.week=function(){var e=this;e.labTmNColor=12300217,e.labTmCColor=16769973,e.labScoreNColor=12300217,e.labScoreCColor=16769973,e.setCurChoose()},t.prototype.sleep=function(){},t.prototype.getViewWidth=function(){return this.groupOB.width},t.prototype.getViewHeight=function(){var e=this,t=e.groupOB.height;return t},t.prototype.setBtnTmContent=function(e){this.labTm.text=e},t.prototype.getBtnTmContent=function(){return this.labTm.text},t.prototype.setBtnScoreContent=function(e){this.labScore.text=e},t.prototype.getBtnScoreContent=function(){return this.labScore.text},t.prototype.setBtnRewardImg=function(e){0==e?this.imgReward.source="combatRecordSheet_json.a22x22_0":this.imgReward.source="combatRecordSheet_json.a22x22_1"},t.prototype.setBtnName=function(e){this.btnRecord.name=e},t.prototype.getBtnName=function(){return this.btnRecord.name},t.prototype.setCurChoose=function(e,t){void 0===e&&(e=0),void 0===t&&(t=!1);var r=this;r.curChooseState!=e&&(r.curChooseState=e,r.labTm.textColor=0==e?r.labTmNColor:r.labTmCColor,r.labScore.textColor=0==e?r.labScoreNColor:r.labScoreCColor,t&&(r.btnRecord.touchEnabled=0==e),r.imgChooseState.visible=1==e)},t.prototype.getCurChooseState=function(){return this.curChooseState},t.NAME="RecordBtnViewSkin",t}(BaseView);__reflect(RecordBtnView.prototype,"RecordBtnView");var SetView=function(e){function t(){var r=e.call(this,t.NAME)||this;return r.nameList=new Array,r}return __extends(t,e),t.prototype.week=function(){var e=this;e.hasEventListener(egret.TouchEvent.TOUCH_TAP)||e.addEventListener(egret.TouchEvent.TOUCH_TAP,e.touchTap,e),e.InitView(),e.sendGetSetData()},t.prototype.InitView=function(){var e=this,t=GlobalDataManager.getInstance().getAccountData();e.useridtxt.text="ID: "+t.uname,e.nicknametxt.text="昵称："+t.nick,e.SwitchSound.selected=!0,"off"==localStorage.getItem("soundSet")&&(e.SwitchSound.selected=!1),e.SwitchMusic.selected=!0,"off"==localStorage.getItem("musicSet")&&(e.SwitchMusic.selected=!1),e.freshMusicSet(),e.freshSoundSet();var r=t.getHead_Url();if(null!=r&&""!=r){var a=new egret.ImageLoader;egret.ImageLoader.crossOrigin="anonymous",a.load(r),a.once(egret.Event.COMPLETE,e.onLoadImgCompleteHandler,e),a.once(egret.IOErrorEvent.IO_ERROR,function(e){console.log("加载网络图片:"+r+" 出现错误!")},e)}},t.prototype.sendGetSetData=function(){var e=new Object;e.param="设置";var t=GlobalDataManager.getInstance().getCenterServer();HttpManager.getInstance().send(t.getSname(),HallCmdDef.CMD_SetConfig,e,!0)},t.prototype.recvData=function(e,t){var r=this;switch(e){case HallCmdDef.CMD_SetConfig:for(var a=t.length,n=0;a>n;n++){var o=t[n];this.nameList[o.position]=o}r.reSetView(null)}},t.prototype.reSetView=function(e){this.kefuwxLabel.text=this.nameList[1].tittle+this.nameList[1].disc,this.kefuqqLabel.text=this.nameList[2].tittle+this.nameList[2].disc,this.label1.text=this.nameList[3].tittle+this.nameList[3].disc,this.label2.text=this.nameList[4].tittle+this.nameList[4].disc,this.label3.text=this.nameList[5].tittle+this.nameList[5].disc},t.prototype.onLoadImgCompleteHandler=function(e){var t=this;if(e.currentTarget.data){var r=new egret.Texture;r.bitmapData=e.currentTarget.data;var a=new egret.Bitmap(r);a.x=0,a.y=0,a.width=t.headgroup.width,a.height=t.headgroup.height,t.headgroup.addChild(a);var n=new egret.Shape;n.graphics.beginFill(0);var o=t.headgroup.width/2,i=t.headgroup.height/2;n.x=o,n.y=i,n.graphics.drawCircle(0,0,o),n.graphics.endFill(),t.headgroup.addChild(n),a.mask=n}},t.prototype.sleep=function(){},t.prototype.freshSoundSet=function(){1==this.SwitchSound.selected?(this.soundtxt.textColor=16777215,localStorage.setItem("soundSet","on")):(this.soundtxt.textColor=6158955,localStorage.setItem("soundSet","off"))},t.prototype.freshMusicSet=function(){1==this.SwitchMusic.selected?(this.musictxt.textColor=16777215,localStorage.setItem("musicSet","on")):(this.musictxt.textColor=6158955,localStorage.setItem("musicSet","off"))},t.prototype.touchTap=function(e){var t=this,r=e.target;r instanceof eui.Button&&(r==t.btnBack?t.hiden():r==t.BtnZhuXiao?console.log("注销退出"):r==t.BtnKeFu?console.log("客服"):r==t.SwitchMusic?(console.log("背景音乐开关："+t.SwitchMusic.selected),this.freshMusicSet()):r==t.SwitchSound?(console.log("音效开关："+t.SwitchSound.selected),this.freshSoundSet()):r==t.SwitchNotify&&console.log("通知开关："+t.SwitchNotify.selected))},t.NAME="SetSkin",t}(BaseView);__reflect(SetView.prototype,"SetView");var CardGroupSetView=function(e){function t(){var r=e.call(this,t.NAME)||this;return r.arrCardFetters=new Array,r.arrSCardItem=new Array,r.arrRCardItem=new Array,r.bRCardScale=.54,r.cRCardScale=.35,r.onChangeStart=!1,r.arrRCardPosX=new Array,r.arrSort1=["战力由高到低","战力由低到高","攻击由高到低","攻击由低到高","生命由高到低","生命由低到高","费用由低到高","费用由高到低"],r.arrSort2=["全品质","普通","稀有","史诗","传说","神话"],r.arrSort3=["全五行","金","木","水","火","土"],r.arrSortBtn1=["战力由高到低","战力由低到高","攻击由高到低","攻击由低到高","生命由高到低","生命由低到高","费用由低到高","费用由高到低"],r.arrSortBtn2=["全品质","普通","稀有","史诗","传说","神话"],r.arrSortBtn3=["全五行","金","木","水","火","土"],r.sortFactor={sort:0,rarity:0,element:0},r.pageNum=1,r.pageSize=10,r.cardCostStr="",r.movingState=!1,r}return __extends(t,e),t.prototype.week=function(){var t=this;t.hasEventListener(egret.TouchEvent.TOUCH_TAP)||t.addEventListener(egret.TouchEvent.TOUCH_TAP,t.touchTap,t),t.scrCCardItem.addEventListener(eui.UIEvent.CHANGE_START,t.onChangeStartHandler,t),t.scrCCardItem.addEventListener(egret.Event.CHANGE,t.onChangeHanlder,t),t.scrCCardItem.addEventListener(eui.UIEvent.CHANGE_END,t.onChangeEndHandler,t),t.scrCCardItem.addEventListener(egret.TouchEvent.TOUCH_CANCEL,t.onCancelHandler,t),t.scrCCardItem.addEventListener(egret.TouchEvent.TOUCH_END,t.onEndHandler,t),t.initView(),t.sendGetCardList();var r=e.prototype.getData.call(this);if(null!=r){var a=r.arrTeamConfig;t.initTeamConfig(a);var n=r.teamData;if(t.setTeamItem(n),null!=n){var o=n.name;t.setCardGroupName(o)}t.callBackUpdateTeam=r.cbUpdateTeam}},t.prototype.initView=function(){var e=this;e.pageNum=1,e.btnDetails.visible=!1,e.curChooseRCardIndex=-1,e.lblCCost.text="0/0",e.lblCHp.text="0",e.lblCAtk.text="0",e.lblCCapacity.text="0",e.lblCEle.text="",e.lblCFetters.text="",e.btnSort.label=e.arrSortBtn1[e.sortFactor.sort],e.btnQuality.label=e.arrSortBtn2[e.sortFactor.rarity],e.btnElements.label=e.arrSortBtn3[e.sortFactor.element],e.removeRCardItem(),e.setUserInfo()},t.prototype.sleep=function(){var e=this;for(e.hasEventListener(egret.TouchEvent.TOUCH_TAP)&&e.removeEventListener(egret.TouchEvent.TOUCH_TAP,e.touchTap,e),e.scrCCardItem.removeEventListener(eui.UIEvent.CHANGE_START,e.onChangeStartHandler,e),e.scrCCardItem.removeEventListener(egret.Event.CHANGE,e.onChangeHanlder,e),e.scrCCardItem.removeEventListener(eui.UIEvent.CHANGE_END,e.onChangeEndHandler,e),null!=e.cCardScrViewGroup&&(e.cCardScrViewGroup.parent.removeChild(e.cCardScrViewGroup),e.cCardScrViewGroup=null),e.cleanArray(e.arrSCardItem),e.cleanArray(e.arrCardFetters),e.cleanArray(e.arrRCardItem);e.arrRCardPosX.length;)e.arrRCardPosX.pop()},t.prototype.cleanArray=function(e){if(!(null==e||e.length<=0))for(var t=e.length-1;t>=0;t--){var r=e[t];if(null!=r){var a=r.parent;a.removeChild(r)}e.splice(t,1)}},t.prototype.touchTap=function(e){var t=this;if(e.target instanceof eui.Button){var r=e.target;if(r==t.btnSort){var a={desArr:t.arrSort1,cbHandler:Handler.create(t,t.onChooseCardSort1),selIndex:t.sortFactor.sort};UIManager.getInstance().showUI(CGPSortView,GameScene.VIEW_LAYER_NUMBER,-1,0,0,0,a)}else if(r==t.btnQuality){var a={desArr:t.arrSort2,cbHandler:Handler.create(t,t.onChooseCardSort2),selIndex:t.sortFactor.rarity};UIManager.getInstance().showUI(CGPSortView,GameScene.VIEW_LAYER_NUMBER,-1,0,0,0,a)}else if(r==t.btnElements){var a={desArr:t.arrSort3,cbHandler:Handler.create(t,t.onChooseCardSort3),selIndex:t.sortFactor.element};UIManager.getInstance().showUI(CGPSortView,GameScene.VIEW_LAYER_NUMBER,-1,0,0,0,a)}else if(r==t.btnSave)t.sendSaveTeam();else if(r==t.btnBack)t.hiden();else if(r==t.btnDetails&&-1!=t.curChooseRCardIndex){var n=t.arrRCardItem[t.curChooseRCardIndex],o=n.getData();if(null==o)return;var i=o.code;null!=i&&t.showCardDetailView(i)}}else if(e.target instanceof eui.Group){var l=e.target;if("groupCR_"==l.name.substr(0,8)){if(t.movingState)return;var s=l.name.split("_");if(2!=s.length)return;var c=Number(s[1]);t.onClickRCardItem(c)}else if("groupCGSCI_"==l.name.substr(0,11)){var s=l.name.split("_");if(2!=s.length)return;var c=Number(s[1]);t.onClickSCardItem(c)}}},t.prototype.onClickRCardItem=function(e){var t=this;if(t.curChooseRCardIndex!=e)return void t.scrollToItem(e);var r=t.arrRCardItem[e];if(null!=r){var a=r.getData();if(null!=a&&null!=a.code){var n=a.code,o=t.getSCardItemIndex(n);if(-1!=o)t.onRemoveSCardItem(o);else{for(var i=0,l=t.arrSCardItem.length;l>i;i++){var s=t.arrSCardItem[i];if(null!=s&&1==s.getType()){o=i;break}}-1!=o&&(t.setSCardItem(o,a),t.updateBCardSelShow(),t.updateCardGroupAttribute())}}}},t.prototype.onChangeCardSort=function(e,t){var r=this;if(null!=r.sortFactor){var a="";a=1==e?"sort":2==e?"rarity":"element";var n=r.sortFactor[a],o=!0;(null==n||n==t)&&(o=!1),o?(r.sortFactor[a]=t,r.pageNum=1,r.sendGetCardList(),r.btnSort.label=r.arrSortBtn1[r.sortFactor.sort],r.btnQuality.label=r.arrSortBtn2[r.sortFactor.rarity],r.btnElements.label=r.arrSortBtn3[r.sortFactor.element]):UIManager.getInstance().hideUI(CGPSortView)}},t.prototype.onChooseCardSort1=function(e){this.onChangeCardSort(1,e)},t.prototype.onChooseCardSort2=function(e){this.onChangeCardSort(2,e)},t.prototype.onChooseCardSort3=function(e){this.onChangeCardSort(3,e)},t.prototype.onClickSCardItem=function(e){var t=this;if(null!=t.arrSCardItem){var r=t.arrSCardItem[e];if(null!=r&&null!=r.getType()&&0==r.getType()){var a=r.getCardData();if(null!=a){var n=a.code;t.showCardDetailView(n)}}}},t.prototype.showCardDetailView=function(e){if(null!=e&&""!=e){for(var t=this,r=null,a=null==t.arrCardDetailData?0:t.arrCardDetailData.length,n=0;a>n;n++){var o=t.arrCardDetailData[n];if(null!=o&&o.code==e){r=o;break}}if(null==r){var i=GlobalDataManager.getInstance().getCenterServer(),l={code:e};return void HttpManager.getInstance().send(i.getSname(),HallCmdDef.CMD_GET_CARD_DETAIL_TEAMSET,l)}for(var s=-1,n=0,a=t.arrSCardItem.length;a>n;n++){var c=t.arrSCardItem[n];if(null!=c&&0==c.getType()&&null!=c.getCardData()&&c.getCardData().code==e){s=n;break}}var p={cdata:r};-1!=s&&(p.cbRemove=Handler.create(t,t.onRemoveSCardItem,[s])),UIManager.getInstance().showUI(CGDetailView,GameScene.VIEW_LAYER_NUMBER,-1,0,0,0,p)}},t.prototype.onRemoveSCardItem=function(e){if(!(null==e||0>e)){var t=this,r=t.arrSCardItem[e];null!=r&&(r.updateShow({type:1}),t.updateBCardSelShow(),UIManager.getInstance().hideUI(CGDetailView),t.updateCardGroupAttribute())}},t.prototype.setCardGroupAttribute=function(e,t,r,a){var n=this;n.lblCCost.text=e,n.lblCHp.text=t+"",n.lblCAtk.text=r+"",n.lblCCapacity.text=t+r+"",n.lblCEle.text=a},t.prototype.setFromFetter=function(e){this.lblCFetters.text=e},t.prototype.initTeamConfig=function(e){var t=this;t.arrTeamConfig=e;for(var r=GlobalDataManager.getInstance().getAccountData(),a=5,n=0,o=t.scrSCardItem.width/a,i=0,l=0,s=e.length;s>l;l++){var c=e[l];if(null!=c){var p=c.unlocklvl;if(null!=p){var u=2;null!=r&&r.getLvl()>=p&&(u=1);var h="groupCGSCI_"+l,d={type:u,sdata:p,gname:h},g=new CGSCardItemView;g.initData(d),t.groupSCardItem.addChild(g),g.x=n*o;var m=g.getViewHeight();g.y=i*(m+10),t.arrSCardItem.push(g),n++,n>=a&&(n=0,i++)}}}},t.prototype.setTeamItem=function(e){for(var t=this,r=e,a=0,n=t.arrTeamConfig.length;n>a;a++){var o=t.arrTeamConfig[a];if(null!=o){var i=o.code;if(null!=r&&null!=r[i]){var l=r[i];t.setSCardItem(a,l)}}}t.updateCardGroupAttribute()},t.prototype.updateCardGroupAttribute=function(){for(var e=this,t=0,r=0,a=0,n="",o="",i=new Array,l=0,s=e.arrSCardItem.length;s>l;l++){var c=e.arrSCardItem[l];if(null!=c&&null!=c.getCardData()){var p=c.getCardData(),u=p.code;i.push(u);var h=p.hp,d=p.atk,g=p.cost,m=p.element;t+=h,r+=d,a+=g,5>l?n+=GlobalDef.getInstance().getCardElement(m):o+=GlobalDef.getInstance().getCardElement(m)}}var C=GlobalDataManager.getInstance().getAccountData();e.cardCostStr=a+"/"+C.getCost(),e.setCardGroupAttribute(e.cardCostStr,t,r,n+"\n"+o),i.length<=0?e.setFromFetter(""):e.sendGetTeamFromFetters(i)},t.prototype.setSCardItem=function(e,t){var r=this;if(null!=r.arrSCardItem){var a=r.arrSCardItem[e];if(null!=a){var n={type:0,sdata:t};a.updateShow(n)}}},t.prototype.setRCardItem=function(e){var t=this;1==t.pageNum&&t.removeRCardItem();for(var r=10,a=0,n=t.arrRCardItem.length,o=null==e?n:n+e.length,i=n;o>i;i++){var l=i-n,s=e[l];if(null!=s){var c=new CardRectangleView,p=s;p.groupName="groupCR_"+i,c.initData(p),t.groupCCardItem.addChild(c),0==a&&(a=c.getViewWidth());var u=i*(a*t.cRCardScale+r);c.x=u,c.y=0,c.scaleX=c.scaleY=t.cRCardScale,t.arrRCardItem.push(c),t.arrRCardPosX.push(u)}}if(o-n<t.pageSize&&null==t.cCardScrViewGroup){var h=new eui.Group;0==a&&t.arrRCardItem.length>0&&(a=t.arrRCardItem[0].getViewWidth()),h.x=a*t.cRCardScale*(o+1),h.y=0,h.width=t.scrCCardItem.width,h.height=0,t.groupCCardItem.addChild(h),t.cCardScrViewGroup=h}t.checkScale(),t.updateBCardSelShow()},t.prototype.setUserInfo=function(){var e=this;GlobalDataManager.getInstance().getAccountData();if(e.groupIcon.numChildren<=0){var t=new egret.Shape;t.graphics.beginFill(0);var r=e.groupIcon.width/2,a=e.groupIcon.height/2;t.x=r,t.y=a,t.graphics.drawCircle(0,0,r),t.graphics.endFill(),e.groupIcon.addChild(t),e.iconMaskShape=t;var n="http://dl.bbs.9game.cn/attachments/forum/202002/24/163438cmy1qemiieaefmym.png";if(null!=n&&""!=n){var o=new egret.ImageLoader;egret.ImageLoader.crossOrigin="anonymous",o.load(n),o.once(egret.Event.COMPLETE,e.onLoadImgCompleteHandler,e),o.once(egret.IOErrorEvent.IO_ERROR,function(e){console.log("加载网络图片:"+n+" 出现错误!")},e)}}},t.prototype.onLoadImgCompleteHandler=function(e){var t=this;if(e.currentTarget.data){var r=new egret.Texture;r.bitmapData=e.currentTarget.data;var a=new egret.Bitmap(r);a.x=0,a.y=0,a.width=t.groupIcon.width,a.height=t.groupIcon.height,t.groupIcon.addChild(a),null!=t.iconMaskShape&&(a.mask=t.iconMaskShape)}},t.prototype.removeRCardItem=function(){for(var e=this;e.arrRCardPosX.length;)e.arrRCardPosX.pop();e.cleanArray(e.arrRCardItem),null!=e.cCardScrViewGroup&&(e.cCardScrViewGroup.parent.removeChild(e.cCardScrViewGroup),e.cCardScrViewGroup=null),e.curChooseRCardIndex=-1,e.scrCCardItem.viewport.scrollH=0},t.prototype.addCardDetail=function(e){var t=this;null==t.arrCardDetailData&&(t.arrCardDetailData=new Array);for(var r=e.code,a=!1,n=0,o=t.arrCardDetailData.length;o>n;n++){var i=t.arrCardDetailData[n];if(null!=i&&r==i.code){a=!0;break}}a||t.arrCardDetailData.push(e),t.showCardDetailView(r)},t.prototype.recvData=function(e,t){var r=this;switch(e){case HallCmdDef.CMD_GET_CARD_LIST_TEAMSET:r.setRCardItem(t),UIManager.getInstance().hideUI(CGPSortView);break;case HallCmdDef.CMD_GET_CARD_DETAIL_TEAMSET:r.addCardDetail(t);break;case HallCmdDef.CMD_SAVE_TEAMSET:r.onSaveTeamComplete();break;case HallCmdDef.CMD_GET_FROM_FETTER_TEAMSET:r.onGetTeamFromFetters(t)}},t.prototype.onSaveTeamComplete=function(){var t=this,r={},a=e.prototype.getData.call(this);if(null!=a){a.cardGroupName;r.name=t.editName.text;var n=a.teamData;if(null!=n){var o=n.c_index;r.c_index=o;for(var i=0,l=t.arrTeamConfig.length;l>i;i++){var s=t.arrTeamConfig[i];if(null!=s&&null!=t.arrSCardItem[i]){var c=s.code,p=t.arrSCardItem[i].getCardData();null!=p&&(r[c]=p)}}}}null!=t.callBackUpdateTeam&&t.callBackUpdateTeam.runWith(r),PopManager.getInstance().showPromptBox("保存成功",1,Handler.create(t,function(e){e&&t.hiden()}),["返回卡组","继续配置"])},t.prototype.sendGetCardList=function(){var e=GlobalDataManager.getInstance().getCenterServer(),t=this,r={rarity:t.sortFactor.rarity,element:t.sortFactor.element,sort:t.sortFactor.sort,pageNum:t.pageNum,pageSize:t.pageSize,detail:0};HttpManager.getInstance().send(e.getSname(),HallCmdDef.CMD_GET_CARD_LIST_TEAMSET,r)},t.prototype.sendGetTeamFromFetters=function(e){if(!(null==e||e.length<=0)){var t=GlobalDataManager.getInstance().getCenterServer();HttpManager.getInstance().send(t.getSname(),HallCmdDef.CMD_GET_FROM_FETTER_TEAMSET,{codes:e},!1)}},t.prototype.sendSaveTeam=function(){var t=this,r=t.editName.text;if(""==r)return void PopManager.getInstance().showPromptBox("保存失败!卡组名称不能为空!",2);var a=t.cardCostStr.split("/");if(null!=a&&2==a.length){var n=Number(a[1]),o=Number(a[0]);if(o>n)return void PopManager.getInstance().showPromptBox("保存失败!队伍的cost大于用户目前最大的cost!",2);var i={},l=e.prototype.getData.call(this);if(null!=l){l.cardGroupName;i.name=r;var s=l.teamData,c={};if(null!=s){var p=s.c_index;c.c_index=p;for(var u=!1,h=0,d=t.arrTeamConfig.length;d>h;h++){var g=t.arrTeamConfig[h];if(null!=g&&null!=t.arrSCardItem[h]){var m=g.code,C=t.arrSCardItem[h].getCardData(),f="";null!=C&&null!=C.code&&(f=C.code,u=!0),c[m]=f}}if(!u)return void PopManager.getInstance().showPromptBox("保存失败!配置卡组不能为空!",2)}i.curTeamData=c}var v=GlobalDataManager.getInstance().getCenterServer();HttpManager.getInstance().send(v.getSname(),HallCmdDef.CMD_SAVE_TEAMSET,i)}},t.prototype.setCardFetters=function(e){if(null!=e){var t=this;t.cleanArray(t.arrCardFetters);for(var r=3,a=0,n=t.scrCardFetters.width/r,o=0,i=6,l=e.length<i?i:e.length,s=0;l>s;s++){var c={type:0,fdata:null},p=e[s];null!=p&&(c.type=1,c.fdata={icon:p,canTouch:!1});var u=new CGSFetterItemView;u.initData(c),t.groupCardFetters.addChild(u),u.x=a*(n+5),u.y=o*(u.height+20),t.arrCardFetters.push(u),a++,a>=r&&(a=0,o++)}}},t.prototype.onChangeStartHandler=function(){var e=this;e.onChangeStart=!0,e.btnDetails.visible&&(e.btnDetails.visible=!1)},t.prototype.onChangeHanlder=function(e){var t=this;t.checkScale()},t.prototype.onChangeEndHandler=function(){var e=this;e.onChangeStart&&(e.onChangeStart=!1,e.autoScrollToItem()),null==e.cCardScrViewGroup&&e.scrCCardItem.viewport.scrollH+e.scrCCardItem.width>=e.scrCCardItem.viewport.contentWidth&&(e.pageNum++,e.sendGetCardList())},t.prototype.onCancelHandler=function(){this.movingState=!0},t.prototype.onEndHandler=function(){this.movingState=!1},t.prototype.autoScrollToItem=function(){var e=this;e.scrollToItem(e.curChooseRCardIndex)},t.prototype.scrollToItem=function(e){var t=this;if(-1!=e){t.curChooseRCardIndex=e;var r=t.arrRCardPosX[e];egret.Tween.removeTweens(t.scrCCardItem.viewport),egret.Tween.get(t.scrCCardItem.viewport).to({scrollH:r},100).call(t.checkScale,t),t.updateBCardSelShow()}},t.prototype.updateBCardSelShow=function(){var e=this;e.btnDetails.visible=-1!=e.curChooseRCardIndex;for(var t=0,r=e.arrRCardItem.length;r>t;t++){var a=e.arrRCardItem[t];if(null!=a){var n=a.getData();if(null==n)return;var o=n.code;if(null==o)return;a.setChoose(-1!=e.getSCardItemIndex(o))}}},t.prototype.getSCardItemIndex=function(e){for(var t=this,r=0,a=t.arrSCardItem.length;a>r;r++){var n=t.arrSCardItem[r];if(null!=n&&0==n.getType()&&null!=n.getCardData()&&e==n.getCardData().code)return r}return-1},t.prototype.checkScale=function(){for(var e=this,t=e.scrCCardItem,r=12,a=100-r,n=0,o=e.arrRCardItem.length;o>n;n++){var i=e.arrRCardItem[n];i.x=e.arrRCardPosX[n]+r;var l=i.x-t.viewport.scrollH;if(Math.abs(l)<a&&Math.abs(l)>=0){if(0>l?i.scaleX=i.scaleY=e.bRCardScale+l/1e3:l>0?i.scaleX=i.scaleY=e.bRCardScale-l/1e3:0==Math.abs(l)&&(i.scaleX=i.scaleY=e.bRCardScale),i.y=0,r=i.width*(e.bRCardScale-e.cRCardScale)+25,e.curChooseRCardIndex=n,0!=n){var s=e.arrRCardItem[n-1];s.x=e.arrRCardPosX[n-1]-25}}else i.scaleX=i.scaleY=e.cRCardScale,i.y=35}},t.prototype.setCardGroupName=function(e){if(null!=e){var t=this;t.editName.text=e}},t.prototype.onGetTeamFromFetters=function(e){if(null!=e){var t=this,r=e.fetters,a="",n=new Array;if(null!=r)for(var o in r){var i=r[o];if(null!=i){var l=i.name;a+=l+"\n";var s=i.icon;n.push(s)}}t.setFromFetter(a),t.setCardFetters(n)}},t.prototype.onResize=function(t){e.prototype.onResize.call(this,t);var r=this;if(null!=r.groupCardGroupSet){var a=GlobalDef.SCREEN_WIDTH>GlobalDef.SCREEN_HEIGHT?GlobalDef.SCREEN_WIDTH:GlobalDef.SCREEN_HEIGHT,n=GlobalDef.SCREEN_WIDTH>GlobalDef.SCREEN_HEIGHT?GlobalDef.SCREEN_HEIGHT:GlobalDef.SCREEN_WIDTH,o=r.$stage.stageWidth,i=r.$stage.stageHeight,l=Number((o/i/(a/n)).toFixed(2));
return l>1||0>l?void(r.groupCardGroupSet.scaleX=r.groupCardGroupSet.scaleY=1):void(r.groupCardGroupSet.scaleX=r.groupCardGroupSet.scaleY=l)}},t.NAME="CardGroupSetSkin",t}(BaseView);__reflect(CardGroupSetView.prototype,"CardGroupSetView");var CardGroupView=function(e){function t(){var r=e.call(this,t.NAME)||this;return r.arrCardItem=new Array,r.arrDefaultTeamList=[{name:"卡组1",data:new Object},{name:"卡组2",data:new Object},{name:"卡组3",data:new Object}],r}return __extends(t,e),t.prototype.week=function(){var e=this;e.hasEventListener(egret.TouchEvent.TOUCH_TAP)||e.addEventListener(egret.TouchEvent.TOUCH_TAP,e.touchTap,e),e.initView()},t.prototype.initView=function(){var e=this;null!=e.arrTeamConfig&&e.initTeamConfig(e.arrTeamConfig),e.lblCCost.text="0/0",e.lblCHp.text="0",e.lblCAtk.text="0",e.lblCCapacity.text="0",e.lblCEle.text="",e.lblCFetters.text="",null!=e.teamData?e.initTeamData(e.teamData):e.sendGetTeamList(),e.setUserInfo()},t.prototype.sleep=function(){var e=this;e.hasEventListener(egret.TouchEvent.TOUCH_TAP)&&e.removeEventListener(egret.TouchEvent.TOUCH_TAP,e.touchTap,e),e.cleanArray(e.arrCardItem),e.teamData=null},t.prototype.cleanArray=function(e){if(!(null==e||e.length<=0))for(var t=e.length-1;t>=0;t--){var r=e[t];if(null!=r){var a=r.parent;a.removeChild(r)}e.splice(t,1)}},t.prototype.touchTap=function(e){var t=this;if(e.target instanceof eui.Button){var r=e.target;if(r==t.btnCGChoose){for(var a=new Array,n=-1,o=0,i=t.arrTeamList.length;i>o;o++){var l=t.arrTeamList[o];if(null!=l){a.push(l.name);var s=l.data;if(null!=s){var c=s.battle;null!=c&&1==c&&(n=o)}}}var p={desArr:a,selIndex:n,cbHandler:Handler.create(t,t.onChooseTeamListItem)};UIManager.getInstance().showUI(CGPSortView,GameScene.VIEW_LAYER_NUMBER,-1,0,0,0,p)}else r==t.btnCGEdit?t.showCardGroupSetView():r==t.btnAddLv?UIManager.getInstance().showUI(RoleUpgradeView,GameScene.VIEW_LAYER_NUMBER,-1,0,0,0,{callBackHandler:Handler.create(t,t.onUpdateAccountData,null,!1)}):r==t.btnBack&&t.hiden()}else if(e.target instanceof eui.Group){var u=e.target;if(null==u.name)return;if("groupCGCI_"==u.name.substr(0,10)){var h=u.name.split("_");if(2!=h.length)return;var d=Number(h[1]);t.onClickCardItem(d)}}},t.prototype.showCardGroupSetView=function(){var e=this,t=e.teamData.curBattleTeam;if(null==t||null==t.name){t={};var r=e.lblCGName.text;t.name=r;for(var a=0,n=0,o=e.arrDefaultTeamList.length;o>n;n++){var i=e.arrDefaultTeamList[n];if(null!=i&&null!=i.name&&i.name==r){a=n;break}}t.c_index=a}var l={teamData:t,arrTeamConfig:e.arrTeamConfig,cbUpdateTeam:Handler.create(e,e.onUpdateTeamData)};UIManager.getInstance().showUI(CardGroupSetView,GameScene.VIEW_LAYER_NUMBER,-1,0,0,0,l)},t.prototype.onUpdateTeamData=function(e){this.changeBattleTeam(e)},t.prototype.onChooseTeamListItem=function(e){var t=this,r=t.arrTeamList[e],a=r.data,n=!0;if(null!=a&&null!=a.c_index&&null!=a.battle&&0!=a.battle&&(n=!1),n){for(var o=-1,i=0,l=t.arrTeamList.length;l>i;i++){var s=t.arrTeamList[i];if(null!=s){var c=s.data;if(null!=c){var p=c.battle;if(null!=p&&1==p){o=i;break}}}}o==e&&(n=!1)}if(n){var u=GlobalDataManager.getInstance().getCenterServer();HttpManager.getInstance().send(u.getSname(),HallCmdDef.CMD_CHANGE_BATTLE_TEAM,{c_index:e})}else UIManager.getInstance().hideUI(CGPSortView)},t.prototype.onClickCardItem=function(e){var t=this;if(null!=t.arrCardItem){var r=t.arrCardItem[e];null!=r&&null!=r.getType()&&1==r.getType()&&t.showCardGroupSetView()}},t.prototype.setUserInfo=function(){var e=this,t=GlobalDataManager.getInstance().getAccountData();if(e.lblHp.text=t.getHp()+"",e.onUpdateAccountData(),e.groupIcon.numChildren<=0){var r=new egret.Shape;r.graphics.beginFill(0);var a=e.groupIcon.width/2,n=e.groupIcon.height/2;r.x=a,r.y=n,r.graphics.drawCircle(0,0,a),r.graphics.endFill(),e.groupIcon.addChild(r),e.iconMaskShape=r;var o="http://dl.bbs.9game.cn/attachments/forum/202002/24/163438cmy1qemiieaefmym.png";if(null!=o&&""!=o){var i=new egret.ImageLoader;egret.ImageLoader.crossOrigin="anonymous",i.load(o),i.once(egret.Event.COMPLETE,e.onLoadImgCompleteHandler,e),i.once(egret.IOErrorEvent.IO_ERROR,function(e){console.log("加载网络图片:"+o+" 出现错误!")},e)}}},t.prototype.onLoadImgCompleteHandler=function(e){var t=this;if(e.currentTarget.data){var r=new egret.Texture;r.bitmapData=e.currentTarget.data;var a=new egret.Bitmap(r);a.x=0,a.y=0,a.width=t.groupIcon.width,a.height=t.groupIcon.height,t.groupIcon.addChild(a),null!=t.iconMaskShape&&(a.mask=t.iconMaskShape)}},t.prototype.setCardGroupAttribute=function(e,t,r,a){var n=this;n.lblCCost.text=e,n.lblCHp.text=t+"",n.lblCAtk.text=r+"",n.lblCEle.text=a,n.lblCCapacity.text=t+r+""},t.prototype.setFromFetter=function(e){this.lblCFetters.text=e},t.prototype.setCardGroupName=function(e){var t=this;t.lblCGName.text=e},t.prototype.recvData=function(e,t){var r=this;switch(e){case HallCmdDef.CMD_GET_TEAM_CONFIG:r.initTeamConfig(t),r.sendGetTeamList();break;case HallCmdDef.CMD_GET_TEAM_LIST:r.initTeamData(t);break;case HallCmdDef.CMD_CHANGE_BATTLE_TEAM:r.changeBattleTeam(t),UIManager.getInstance().hideUI(CGPSortView);break;case HallCmdDef.CMD_GET_FROM_FETTER_TEAM:r.onGetTeamFromFetters(t)}},t.prototype.sendGetTeamList=function(){var e=GlobalDataManager.getInstance().getCenterServer(),t=this,r=HallCmdDef.CMD_GET_TEAM_LIST;null==t.arrTeamConfig&&(r=HallCmdDef.CMD_GET_TEAM_CONFIG),HttpManager.getInstance().send(e.getSname(),r,new Object)},t.prototype.sendGetTeamFromFetters=function(e){if(!(null==e||e.length<=0)){var t=GlobalDataManager.getInstance().getCenterServer();HttpManager.getInstance().send(t.getSname(),HallCmdDef.CMD_GET_FROM_FETTER_TEAM,{codes:e},!1)}},t.prototype.initTeamConfig=function(e){if(null!=e){var t=this;t.arrTeamConfig=e;for(var r=GlobalDataManager.getInstance().getAccountData(),a=5,n=0,o=t.scrCardItem.width/a,i=0,l=0,s=e.length;s>l;l++){var c=e[l];if(null!=c){var p=c.unlocklvl;if(null!=p){var u=2;null!=r&&r.getLvl()>=p&&(u=1);var h="groupCGCI_"+l,d={type:u,sdata:p,gname:h},g=new CGCardItemView;g.initData(d),t.groupCardItem.addChild(g),g.x=n*o,g.y=i*(g.getViewHeight()+10),g.width=g.getViewWidth(),g.height=g.getViewHeight(),t.arrCardItem.push(g),n++,n>=a&&(n=0,i++)}}}}},t.prototype.initTeamData=function(e){if(null!=e){var t=this;t.teamData=e,t.setTeamList(e.list),t.setTeamItem(e.curBattleTeam)}},t.prototype.setTeamItem=function(e){var t=this;t.removeCardItem();for(var r=e,a=0,n=t.arrTeamConfig.length;n>a;a++){var o=t.arrTeamConfig[a];if(null!=o){var i=o.code;if(null!=r&&null!=r[i]){var l=r[i];t.setCardItem(a,l)}}}var s=null!=r?r.name:"";if(null==s||""==s){var c=null!=r?r.c_index:0;c=null==c?0:c;var p=t.arrTeamList[c];null!=p&&(s=p.name)}t.setCardGroupName(s),t.updateCardGroupAttribute()},t.prototype.updateCardGroupAttribute=function(){for(var e=this,t=0,r=0,a=0,n="",o="",i=new Array,l=0,s=e.arrCardItem.length;s>l;l++){var c=e.arrCardItem[l];if(null!=c&&null!=c.getCardData()){var p=c.getCardData(),u=p.code;i.push(u);var h=p.hp,d=p.atk,g=p.cost,m=p.element;t+=h,r+=d,a+=g,5>l?n+=GlobalDef.getInstance().getCardElement(m):o+=GlobalDef.getInstance().getCardElement(m)}}var C=GlobalDataManager.getInstance().getAccountData();e.setCardGroupAttribute(a+"/"+C.getCost(),t,r,n+"\n"+o),i.length<=0?e.setFromFetter(""):e.sendGetTeamFromFetters(i)},t.prototype.setTeamList=function(e){if(null!=e){var t=this;t.arrTeamList=t.arrDefaultTeamList;for(var r=e.length,a=0;r>a;a++){var n=e[a];if(null!=n){var o=n.c_index,i=t.arrTeamList[o];null!=i&&(i.name=n.name,i.data=n)}}}},t.prototype.changeBattleTeam=function(e){if(null!=e){var t=this;t.setTeamItem(e);var r=e.c_index;if(null!=t.arrTeamList)for(var a=t.arrTeamList.length,n=0;a>n;n++){var o=t.arrTeamList[n];if(null!=o){var i=o.data,l=0;n==r&&(l=1,null!=e.name&&(o.name=e.name)),(null==i.battle||i.battle!=l)&&(i.battle=l)}}null!=t.teamData&&(t.teamData.curBattleTeam=e)}},t.prototype.setCardItem=function(e,t){var r=this;if(null!=r.arrCardItem){var a=r.arrCardItem[e];if(null!=a){var n={type:0,sdata:t};a.updateShow(n)}}},t.prototype.removeCardItem=function(){var e=this;if(null!=e.arrCardItem)for(var t=GlobalDataManager.getInstance().getAccountData(),r=0,a=e.arrCardItem.length;a>r;r++){var n=e.arrCardItem[r];if(null!=n){var o=2,i=e.arrTeamConfig[r];if(null!=i){var l=i.unlocklvl;null!=t&&t.getLvl()>=l&&(o=1);var s={type:o,sdata:l};n.updateShow(s)}}}},t.prototype.onGetTeamFromFetters=function(e){if(null!=e){var t=this,r=e.fetters,a="";if(null!=r)for(var n in r){var o=r[n];if(null!=o){var i=o.name;a+=i+"\n"}}t.setFromFetter(a)}},t.prototype.onUpdateAccountData=function(){var e=this,t=GlobalDataManager.getInstance().getAccountData();e.lblLv.text=t.getLvl()+"";var r=t.getExp(),a=t.getUpexp();e.lblLvProgress.text=r+"/"+a},t.prototype.onResize=function(t){e.prototype.onResize.call(this,t);var r=this;if(null!=r.groupCardGroup){var a=GlobalDef.SCREEN_WIDTH>GlobalDef.SCREEN_HEIGHT?GlobalDef.SCREEN_WIDTH:GlobalDef.SCREEN_HEIGHT,n=GlobalDef.SCREEN_WIDTH>GlobalDef.SCREEN_HEIGHT?GlobalDef.SCREEN_HEIGHT:GlobalDef.SCREEN_WIDTH,o=r.$stage.stageWidth,i=r.$stage.stageHeight,l=Number((o/i/(a/n)).toFixed(2));return l>1||0>l?void(r.groupCardGroup.scaleX=r.groupCardGroup.scaleY=1):void(r.groupCardGroup.scaleX=r.groupCardGroup.scaleY=l)}},t.NAME="CardGroupSkin",t}(BaseView);__reflect(CardGroupView.prototype,"CardGroupView");var CGAwardView=function(e){function t(){var r=e.call(this,t.NAME)||this;return r.curTypeIndex=0,r.arrFetterItemView=new Array,r.arrSkillItemView=new Array,r}return __extends(t,e),t.prototype.week=function(){var t=this;t.hasEventListener(egret.TouchEvent.TOUCH_TAP)||t.addEventListener(egret.TouchEvent.TOUCH_TAP,t.touchTap,t);var r=e.prototype.getData.call(this);null!=r&&(t.setCard(r),t.setFetter(r.txt))},t.prototype.initView=function(){var e=this;e.btnUnload.visible=!0,e.callBackRemove=null,e.cardCode=""},t.prototype.sleep=function(){var e=this;e.hasEventListener(egret.TouchEvent.TOUCH_TAP)&&e.removeEventListener(egret.TouchEvent.TOUCH_TAP,e.touchTap,e),null!=e.attributeTextField&&(e.attributeTextField.parent.removeChild(e.attributeTextField),e.attributeTextField=null),e.cleanArray(e.arrFetterItemView),e.cleanArray(e.arrSkillItemView)},t.prototype.cleanArray=function(e){if(!(null==e||e.length<=0))for(var t=e.length-1;t>=0;t--){var r=e[t];if(null!=r){var a=r.parent;a.removeChild(r)}e.splice(t,1)}},t.prototype.touchTap=function(e){var t=this,r=e.target;if(r instanceof eui.Button){var a=r;a==t.btnClose?t.hiden():a==t.btnUnload&&null!=t.callBackRemove&&t.callBackRemove.run()}else r instanceof eui.Rect&&r==t.rectBG&&t.hiden()},t.prototype.setCard=function(e){var t=this,r=new CardRectangleView;r.initData(e),r.showSimple(),r.horizontalCenter="0",r.verticalCenter="0",t.groupCard.addChild(r)},t.prototype.setSkillItem=function(e){if(null!=e){var t=this,r={name:e.name,level:e.level,type:e.type,desc:e.desc,fdata:{icon:e.icon,rarity:"common",canTouch:!1}},a=new CGDSkillItemView;a.initData(r),t.groupSkillItem.addChild(a),t.arrSkillItemView.push(a)}},t.prototype.setFetter=function(e){var t=this;t.groupFetterItem.removeChildren();e=e.replace("/r/","\r");var r=new eui.Label("\r"+e);r.$setWidth(560),r.lineSpacing=10,r.size=26,t.groupFetterItem.addChild(r)},t.NAME="CGAwardSkin",t}(BaseView);__reflect(CGAwardView.prototype,"CGAwardView");var CGCardItemView=function(e){function t(){return e.call(this,t.NAME)||this}return __extends(t,e),t.prototype.week=function(){var t=this,r=e.prototype.getData.call(this);if(null!=r){t.updateShow(r);var a=r.gname;t.groupCGCI.name=a}},t.prototype.sleep=function(){},t.prototype.setSCard=function(e){var t=this;t.removeCard(),t.cardData=e;var r=new CardSquareView;r.initData(e),r.scaleX=Number((t.groupCard.width/r.width).toFixed(2)),r.scaleY=Number((t.groupCard.height/r.height).toFixed(2)),t.groupCard.addChild(r),t.cardView=r},t.prototype.removeCard=function(){var e=this;null!=e.cardView&&(e.cardView.parent.removeChild(e.cardView),e.cardView=null),e.cardData=null},t.prototype.setLockLabel=function(e){var t=this;t.lblUnlock.text="LV"+e+"解锁"},t.prototype.getViewWidth=function(){return this.groupCGCI.width},t.prototype.getViewHeight=function(){return this.groupCGCI.height},t.prototype.getType=function(){return this.type},t.prototype.getCardData=function(){return this.cardData},t.prototype.updateShow=function(e){var t=this,r=e.type,a=e.sdata;t.groupCard.visible=0==r,t.groupAdd.visible=1==r,t.groupUnlock.visible=2==r,t.removeCard(),0==r?t.setSCard(a):2==r&&t.setLockLabel(Number(a)),t.type=r},t.NAME="CGCardItemSkin",t}(IBaseView);__reflect(CGCardItemView.prototype,"CGCardItemView");var CGDetailView=function(e){function t(){var r=e.call(this,t.NAME)||this;return r.curTypeIndex=0,r.arrFetterItemView=new Array,r.arrSkillItemView=new Array,r}return __extends(t,e),t.prototype.week=function(){var t=this;t.hasEventListener(egret.TouchEvent.TOUCH_TAP)||t.addEventListener(egret.TouchEvent.TOUCH_TAP,t.touchTap,t),t.initView();var r=e.prototype.getData.call(this);if(null!=r){var a=r.cdata;if(null!=a){var n=a.cardDetail;if(null!=n){var o=n.attribute;null!=o&&(t.setCard(o),t.setAttribute(o),t.cardName=o.name);var i=n.skills;null!=i&&t.setSkill(i);var l=n.fetters;null!=l&&t.setFetter(l)}t.cardCode=a.code,t.callBackRemove=r.cbRemove,t.btnUnload.visible=null!=t.callBackRemove}}},t.prototype.initView=function(){var e=this;e.btnUnload.visible=!0,e.callBackRemove=null,e.cardCode="",e.cardName="",e.selTypeGroup(0)},t.prototype.sleep=function(){var e=this;e.hasEventListener(egret.TouchEvent.TOUCH_TAP)&&e.removeEventListener(egret.TouchEvent.TOUCH_TAP,e.touchTap,e),null!=e.attributeTextField&&(e.attributeTextField.parent.removeChild(e.attributeTextField),e.attributeTextField=null),e.cleanArray(e.arrFetterItemView),e.cleanArray(e.arrSkillItemView)},t.prototype.cleanArray=function(e){if(!(null==e||e.length<=0))for(var t=e.length-1;t>=0;t--){var r=e[t];if(null!=r){var a=r.parent;a.removeChild(r)}e.splice(t,1)}},t.prototype.touchTap=function(e){var t=this,r=e.target;if(r instanceof eui.Button){var a=r;a==t.btnClose?t.hiden():a==t.btnUnload&&null!=t.callBackRemove&&t.callBackRemove.run()}else r instanceof eui.Rect?r==t.rectBG&&t.hiden():r instanceof eui.Image&&(r==t.imgAttribute?0!=t.curTypeIndex&&t.selTypeGroup(0):r==t.imgSkill?1!=t.curTypeIndex&&t.selTypeGroup(1):r==t.imgFetter&&2!=t.curTypeIndex&&t.selTypeGroup(2))},t.prototype.getTypeBGImage=function(e){var t,r=this;return 0==e?t=r.imgAttribute:1==e?t=r.imgSkill:2==e&&(t=r.imgFetter),t},t.prototype.getTypeLabelImage=function(e){var t,r=this;return 0==e?t=r.imgAttributeLabel:1==e?t=r.imgSkillLabel:2==e&&(t=r.imgFetterLabel),t},t.prototype.selTypeGroup=function(e){var t,r,a=this;null!=a.curTypeIndex&&(t=a.getTypeBGImage(a.curTypeIndex),null!=t&&(t.source=a.getImgSourcePrefix(t)+"_0"),r=a.getTypeLabelImage(a.curTypeIndex),null!=r&&(r.source=a.getImgSourcePrefix(r)+"_0")),a.curTypeIndex=e,t=a.getTypeBGImage(a.curTypeIndex),null!=t&&(t.source=a.getImgSourcePrefix(t)+"_1"),r=a.getTypeLabelImage(a.curTypeIndex),null!=r&&(r.source=a.getImgSourcePrefix(r)+"_1"),a.groupAttribute.visible=0==a.curTypeIndex,a.groupSkill.visible=1==a.curTypeIndex,a.groupFetter.visible=2==a.curTypeIndex},t.prototype.getImgSourcePrefix=function(e){var t="",r=e.source,a=r.toString().split(".");if(2==a.length){var n=a[1].split("_");2==n.length&&(t=a[0]+"."+n[0])}return t},t.prototype.setCard=function(e){var t=this,r=e;r.canTouch=!1;var a=new CardRectangleView;a.initData(r),a.horizontalCenter="0",a.verticalCenter="0",t.groupCard.addChild(a)},t.prototype.setAttribute=function(e){var t=this,r=null;null==t.attributeTextField0?(r=new egret.TextField,r.textColor=16777215,r.size=22,r.lineSpacing=40,t.groupAttTextField.addChild(r),r.fontFamily="SimHei",t.attributeTextField0=r):r=t.attributeTextField0;var a=null;null==t.attributeTextField1?(a=new egret.TextField,a.textColor=16777215,a.size=22,a.lineSpacing=40,a.x=240,t.groupAttTextField.addChild(a),a.fontFamily="SimHei",t.attributeTextField1=a):a=t.attributeTextField1;var n=e.rarity,o=GlobalDef.getInstance().getCardRarity(n),i=e.generation,l=this.levelnumTo5lvl(e.level);l=(l-1)%1+1;var s=i+"代"+l+"星",c=e.atk,p=e.cost,u=e.att,h=e.hp,d=e.hit,g=e.agl,m=e.cri_chance,C=e.cri_multiplier,f=e.rgn;r.textFlow=[{text:"品质: ",style:{textColor:14013909}},{text:o+"\n",style:{textColor:16777215}},{text:"星级: ",style:{textColor:14013909}},{text:s+"\n",style:{textColor:16777215}},{text:"战力: ",style:{textColor:14013909}},{text:c+h+"\n",style:{textColor:16777215}},{text:"费用: ",style:{textColor:14013909}},{text:p+"\n",style:{textColor:16777215}},{text:"等待回合: ",style:{textColor:14013909}},{text:u+"\n",style:{textColor:16777215}},{text:"生命: ",style:{textColor:14013909}},{text:h+"\n",style:{textColor:16777215}}],a.textFlow=[{text:"攻击: ",style:{textColor:14013909}},{text:c+"\n",style:{textColor:16777215}},{text:"命中率: ",style:{textColor:14013909}},{text:d+"\n",style:{textColor:16777215}},{text:"闪避率: ",style:{textColor:14013909}},{text:g+"\n",style:{textColor:16777215}},{text:"暴击率: ",style:{textColor:14013909}},{text:m+"\n",style:{textColor:16777215}},{text:"暴击倍数: ",style:{textColor:14013909}},{text:C+"\n",style:{textColor:16777215}},{text:"回复: ",style:{textColor:14013909}},{text:f+"\n",style:{textColor:16777215}}]},t.prototype.levelnumTo5lvl=function(e){return(e-1)%5+1},t.prototype.setSkill=function(e){if(null!=e){var t=this;for(var r in e){var a=e[r];null!=a&&t.setSkillItem(a)}}},t.prototype.setFetter=function(e){if(null!=e){var t=this;for(var r in e){var a=e[r];null!=a&&t.setFetterItem(a)}}},t.prototype.setSkillItem=function(e){if(null!=e){var t=this,r={name:e.name,level:e.level,type:e.type,desc:e.desc,fdata:{icon:e.icon,rarity:e.level,canTouch:!1}},a=new CGDSkillItemView;a.initData(r),t.groupSkillItem.addChild(a),t.arrSkillItemView.push(a)}},t.prototype.setFetterItem=function(e){if(null!=e){var t=this,r={name:e.name,desc:e.desc,cname:t.cardName,compose:e.zc,fdata:{icon:e.icon,canTouch:!1}},a=new CGDFetterItemView;a.initData(r),t.groupFetterItem.addChild(a),t.arrFetterItemView.push(a)}},t.prototype.onResize=function(t){e.prototype.onResize.call(this,t);var r=this;if(null!=r.groupCGDetail){var a=GlobalDef.SCREEN_WIDTH>GlobalDef.SCREEN_HEIGHT?GlobalDef.SCREEN_WIDTH:GlobalDef.SCREEN_HEIGHT,n=GlobalDef.SCREEN_WIDTH>GlobalDef.SCREEN_HEIGHT?GlobalDef.SCREEN_HEIGHT:GlobalDef.SCREEN_WIDTH,o=r.$stage.stageWidth,i=r.$stage.stageHeight,l=Number((o/i/(a/n)).toFixed(2));return l>1||0>l?void(r.groupCGDetail.scaleX=r.groupCGDetail.scaleY=1):void(r.groupCGDetail.scaleX=r.groupCGDetail.scaleY=l)}},t.NAME="CGDetailSkin",t}(BaseView);__reflect(CGDetailView.prototype,"CGDetailView");var CGDFetterItemView=function(e){function t(){return e.call(this,t.NAME)||this}return __extends(t,e),t.prototype.week=function(){var t=this,r=e.prototype.getData.call(this);if(null!=r){var a=r.name;t.setName(a);var n=r.desc;t.setDesc(n);var o=r.cname,i=r.compose;t.setCompose(i,o);var l=r.fdata;t.setFetterIcon(l)}},t.prototype.sleep=function(){var e=this;null!=e.cardFetterView&&(e.cardFetterView.parent.removeChild(e.cardFetterView),e.cardFetterView=null)},t.prototype.setName=function(e){var t=null==e||void 0==e?"":e;this.lblName.text=t},t.prototype.setDesc=function(e){var t=null==e||void 0==e?"":e;this.lblDes.text="效果:"+t},t.prototype.setFetterIcon=function(e){var t=this,r=new CardFetterView;r.initData(e),t.groupFetterIcon.addChild(r),r.scaleX=r.scaleY=.46,t.cardFetterView=r},t.prototype.setCompose=function(e,t){var r=this,a=null==e||void 0==e?"":e;if(""!=a&&""!=t){var n=e.split(t);n.length>1?r.lblCompose.textFlow=[{text:"组成:"+n[0],style:{size:18,textColor:16777215}},{text:t,style:{size:18,textColor:5006319}},{text:n[1],style:{size:18,textColor:16777215}}]:r.lblCompose.text="组成:"+a}else r.lblCompose.text=""},t.NAME="CGDFetterItemSkin",t}(IBaseView);__reflect(CGDFetterItemView.prototype,"CGDFetterItemView");var CGDSkillItemView=function(e){function t(){return e.call(this,t.NAME)||this}return __extends(t,e),t.prototype.week=function(){var t=this,r=e.prototype.getData.call(this);if(null!=r){var a=r.name,n=r.level,o=r.type;t.setSkillTextField(a,n,o);var i=r.desc;t.setDes(i);var l=r.fdata;t.setSkillIcon(l)}},t.prototype.sleep=function(){var e=this;null!=e.skillTextField&&(e.skillTextField.parent.removeChild(e.skillTextField),e.skillTextField=null),null!=e.cardSkillView&&(e.cardSkillView.parent.removeChild(e.cardSkillView),e.cardSkillView=null)},t.prototype.setSkillTextField=function(e,t,r){var a=this,n=null==e||void 0==e?"":e,o=null==t||void 0==t?"LV.0":"LV."+t;r=null==r||void 0==r?2:r;var i=2==r?"被动技能":"主动技能",l=2==r?4702463:16662335,s=new egret.TextField;s.textColor=16777215,s.size=22,a.groupSTextField.addChild(s),s.fontFamily="SimHei",s.textFlow=[{text:n+"   ",style:{textColor:11974326}},{text:o+"   ",style:{textColor:11974326}},{text:i,style:{textColor:l}}],a.skillTextField=s;var c="",p=a.imgBG.source,u=p.toString().split(".");2==u.length&&(c=u[0]);var h=2==r?c+".a98x140":c+".b98x140";a.imgBG.source=h},t.prototype.setDes=function(e){var t=null==e||void 0==e?"":e;this.lblDes.text=t},t.prototype.setSkillIcon=function(e){var t=this,r=new CardSkillView;r.initData(e),t.groupSkillIcon.addChild(r),t.cardSkillView=r},t.NAME="CGDSkillItemSkin",t}(IBaseView);__reflect(CGDSkillItemView.prototype,"CGDSkillItemView");var CGPSortItemView=function(e){function t(){return e.call(this,t.NAME)||this}return __extends(t,e),t.prototype.week=function(){var t=e.prototype.getData.call(this);if(null!=t){var r=this,a=t.des;r.setDes(a);var n=t.gName;r.setGroupName(n)}},t.prototype.sleep=function(){},t.prototype.setDes=function(e){var t=null==e||void 0==e?"":e;this.lblDes.text=t},t.prototype.setGroupName=function(e){var t=null==e||void 0==e?"":e;this.groupCGPSI.name=t},t.prototype.setImgBG=function(){},t.NAME="CGPSortItemSkin",t}(IBaseView);__reflect(CGPSortItemView.prototype,"CGPSortItemView");var CGPSortView=function(e){function t(){var r=e.call(this,t.NAME)||this;return r.arrSortItem=new Array,r.arrSIPosY=new Array,r.isTouchMove=!1,r}return __extends(t,e),t.prototype.week=function(){var t=this;t.hasEventListener(egret.TouchEvent.TOUCH_TAP)||t.addEventListener(egret.TouchEvent.TOUCH_TAP,t.touchTap,t),t.hasEventListener(egret.TouchEvent.TOUCH_MOVE)||t.addEventListener(egret.TouchEvent.TOUCH_MOVE,t.touchMove,t),t.scrSortItem.addEventListener(eui.UIEvent.CHANGE_START,t.onChangeStartHandler,t),t.scrSortItem.addEventListener(egret.Event.CHANGE,t.onChangeHanlder,t),t.scrSortItem.addEventListener(eui.UIEvent.CHANGE_END,t.onChangeEndHandler,t);var r=e.prototype.getData.call(this);if(null!=r){var a=r.desArr;t.setSortItem(a);var n=r.selIndex,o=r.selStr;if(null!=a&&null==n&&null!=o)for(var i=0,l=a.length;l>i;i++){var s=a[i];if(null!=s&&s==o){n=i;break}}n=null==n||void 0==n?-1:n,t.scrollToItem(n,!1);var c=r.clickMove;c=null==c?!0:c,t.clickMove=c,t.callBackHandler=r.cbHandler}},t.prototype.sleep=function(){var e=this;for(e.hasEventListener(egret.TouchEvent.TOUCH_TAP)&&e.removeEventListener(egret.TouchEvent.TOUCH_TAP,e.touchTap,e),e.scrSortItem.removeEventListener(eui.UIEvent.CHANGE_START,e.onChangeStartHandler,e),e.scrSortItem.removeEventListener(egret.Event.CHANGE,e.onChangeHanlder,e),e.scrSortItem.removeEventListener(eui.UIEvent.CHANGE_END,e.onChangeEndHandler,e),null!=e.sortItemScrViewGroup0&&(e.sortItemScrViewGroup0.parent.removeChild(e.sortItemScrViewGroup0),e.sortItemScrViewGroup0=null),null!=e.sortItemScrViewGroup1&&(e.sortItemScrViewGroup1.parent.removeChild(e.sortItemScrViewGroup1),e.sortItemScrViewGroup1=null),e.cleanArray(e.arrSortItem);e.arrSIPosY.length;)e.arrSIPosY.pop()},t.prototype.cleanArray=function(e){if(!(null==e||e.length<=0))for(var t=e.length-1;t>=0;t--){var r=e[t];if(null!=r){var a=r.parent;a.removeChild(r)}e.splice(t,1)}},t.prototype.touchMove=function(e){this.isTouchMove=!0},t.prototype.touchTap=function(e){var t=this,r=e.target;if(r instanceof eui.Rect)r==t.rectBG&&t.hiden();else if(e.target instanceof eui.Group){var a=r;if("groupCGPSI_"==a.name.substr(0,11)){var n=a.name.split("_");if(2!=n.length)return;var o=Number(n[1]);0==this.isTouchMove&&t.onClickSortItem(o)}}this.isTouchMove=!1},t.prototype.onClickSortItem=function(e){var t=this;t.curChooseSIIndex==e?null!=t.callBackHandler&&t.callBackHandler.runWith([e]):t.clickMove&&t.scrollToItem(e)},t.prototype.setSortItem=function(e){if(null!=e){var t=this;t.sortItemViewHeight=0;for(var r=0,a=e.length,n=0,o=0;a>o;o++){var i=new CGPSortItemView;i.initData({des:e[o],gName:"groupCGPSI_"+o}),t.groupSortItem.addChild(i),0==t.sortItemViewHeight&&(t.sortItemViewHeight=i.height),0==r&&(r=t.scrSortItem.height/2-t.sortItemViewHeight/2),i.horizontalCenter="0";var l=o*i.height+r;i.y=l,t.arrSortItem.push(i),t.arrSIPosY.push(l)}var s=new eui.Group;s.x=0,s.y=0,s.width=0,s.height=t.scrSortItem.height/2-t.sortItemViewHeight/2,t.groupSortItem.addChild(s),t.sortItemScrViewGroup0=s;var c=new eui.Group;c.x=0,c.y=t.sortItemViewHeight*a+r,c.width=0,c.height=t.scrSortItem.height/2-t.sortItemViewHeight/2,t.groupSortItem.addChild(c),t.sortItemScrViewGroup1=c,t.constChooseSIIndex=n,t.scrollToItem(n,!1)}},t.prototype.onChangeStartHandler=function(){this.onChangeStart=!0},t.prototype.onChangeHanlder=function(e){this.checkScale()},t.prototype.onChangeEndHandler=function(){var e=this;e.onChangeStart&&(e.onChangeStart=!1,this.autoScrollToItem())},t.prototype.autoScrollToItem=function(){var e=this;e.scrollToItem(e.curChooseSIIndex)},t.prototype.scrollToItem=function(e,t){void 0===t&&(t=!0);var r=this;if(-1!=e){r.curChooseSIIndex=e;var a=r.arrSIPosY[e]-r.scrSortItem.height/2+r.sortItemViewHeight/2;egret.Tween.removeTweens(r.scrSortItem.viewport),t?egret.Tween.get(r.scrSortItem.viewport).to({scrollV:a},100).call(r.checkScale,r):(r.scrSortItem.viewport.scrollV=a,r.checkScale())}},t.prototype.checkScale=function(){for(var e=this,t=e.scrSortItem,r=0,a=e.arrSortItem.length;a>r;r++){var n=e.arrSortItem[r],o=n.y-t.viewport.scrollV-t.height/2+e.sortItemViewHeight/2,i=1,l=1;Math.abs(o)<=e.sortItemViewHeight/2&&Math.abs(o)>=0?(i=1,l=1,e.curChooseSIIndex=r):Math.abs(o)<=1.5*e.sortItemViewHeight?(i=.85,l=.7):(i=.7,l=.5),n.scaleX=n.scaleY=i,n.alpha=l,n.y=e.arrSIPosY[r]+(1-i)*e.sortItemViewHeight/2}},t.prototype.onResize=function(t){e.prototype.onResize.call(this,t);var r=this;if(null!=r.groupCGPSort){var a=GlobalDef.SCREEN_WIDTH>GlobalDef.SCREEN_HEIGHT?GlobalDef.SCREEN_WIDTH:GlobalDef.SCREEN_HEIGHT,n=GlobalDef.SCREEN_WIDTH>GlobalDef.SCREEN_HEIGHT?GlobalDef.SCREEN_HEIGHT:GlobalDef.SCREEN_WIDTH,o=r.$stage.stageWidth,i=r.$stage.stageHeight,l=Number((o/i/(a/n)).toFixed(2));return l>1||0>l?void(r.groupCGPSort.scaleX=r.groupCGPSort.scaleY=1):void(r.groupCGPSort.scaleX=r.groupCGPSort.scaleY=l)}},t.NAME="CGPSortSkin",t}(BaseView);__reflect(CGPSortView.prototype,"CGPSortView");var CGSCardItemView=function(e){function t(){return e.call(this,t.NAME)||this}return __extends(t,e),t.prototype.week=function(){var t=this,r=e.prototype.getData.call(this);if(null!=r){t.updateShow(r);var a=r.gname;t.groupCGSCI.name=a}},t.prototype.sleep=function(){var e=this;e.removeCard()},t.prototype.setSCard=function(e){var t=this;t.removeCard(),t.cardData=e;var r=new CardSquareView;r.initData(e),r.scaleX=Number((t.groupCard.width/r.width).toFixed(2)),r.scaleY=Number((t.groupCard.height/r.height).toFixed(2)),t.groupCard.addChild(r),t.cardView=r},t.prototype.removeCard=function(){var e=this;null!=e.cardView&&(e.cardView.parent.removeChild(e.cardView),e.cardView=null),e.cardData=null},t.prototype.setLockLabel=function(e){var t=this;t.lblUnlock.text="LV"+e+"解锁"},t.prototype.getViewWidth=function(){return this.groupCGSCI.width},t.prototype.getViewHeight=function(){return this.groupCGSCI.height},t.prototype.getType=function(){return this.type},t.prototype.getCardData=function(){return this.cardData},t.prototype.updateShow=function(e){var t=this,r=e.type,a=e.sdata;t.groupCard.visible=0==r,t.groupAdd.visible=1==r,t.groupUnlock.visible=2==r,t.removeCard(),0==r?t.setSCard(a):2==r&&t.setLockLabel(Number(a)),t.type=r},t.NAME="CGSCardItemSkin",t}(IBaseView);__reflect(CGSCardItemView.prototype,"CGSCardItemView");var CGSFetterItemView=function(e){function t(){return e.call(this,t.NAME)||this}return __extends(t,e),t.prototype.week=function(){var t=this,r=e.prototype.getData.call(this);if(null!=r){var a=r.type;0==a?t.removeFetter():t.setFetter(r.fdata)}},t.prototype.sleep=function(){var e=this;e.removeFetter()},t.prototype.setFetter=function(e){var t=this;t.removeFetter(),t.imgBG.visible=!1;var r=new CardFetterView;r.initData(e),r.scaleX=Number((t.groupFetter.width/r.width).toFixed(2)),r.scaleY=Number((t.groupFetter.height/r.height).toFixed(2)),t.groupFetter.addChild(r),t.fetterView=r},t.prototype.removeFetter=function(){var e=this;null!=e.fetterView&&(e.fetterView.parent.removeChild(e.fetterView),e.fetterView=null),e.imgBG.visible=!0},t.NAME="CGSFetterItemSkin",t}(IBaseView);__reflect(CGSFetterItemView.prototype,"CGSFetterItemView");var CardFetterItemView=function(e){function t(){return e.call(this,t.NAME)||this}return __extends(t,e),t.prototype.week=function(){var t=this,r=e.prototype.getData.call(this);if(null!=r){var a=r.name;t.setFetterName(a);var n=r.desc;t.setFetterTip1(n);var o=r.zc;t.setFetterTip2(o,r.hero);var i=r.icon;t.setFetterIcon(i)}},t.prototype.sleep=function(){},t.prototype.setFetterTip1=function(e){this.labFetterTip1.text="效果："+e},t.prototype.setFetterTip2=function(e,t){var r=e.split(t);r.length>1?this.labFetterTip2.textFlow=[{text:"组成:"+r[0],style:{size:18,textColor:16777215}},{text:t,style:{size:18,textColor:5006319}},{text:r[1],style:{size:18,textColor:16777215}}]:this.labFetterTip2.text="组成："+e},t.prototype.setFetterName=function(e){this.labFetterName.text=e},t.prototype.setFetterIcon=function(e){var t=new CardFetterView,r={icon:e,canTouch:!1};t.initData(r),this.groupFetterIcon.addChild(t),t.scaleX=t.scaleY=this.groupFetterIcon.width/t.width},t.prototype.getViewWidth=function(){return this.groupFetterItem.width},t.prototype.getViewHeight=function(){return this.groupFetterItem.height},t.NAME="CardFetterItemSkin",t}(BaseView);__reflect(CardFetterItemView.prototype,"CardFetterItemView");var HallDecoder=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.funcPrefix="method_",t}return __extends(t,e),t.prototype.initDecoderFunction=function(){var e=this;for(var t in HallCmdDef){var r=t;if(isNaN(r)){var a=HallCmdDef[t],n=a,o=e[e.funcPrefix+n];o&&e.registerCmd(n,o)}}},t.prototype.removeDecoderFunction=function(){var e=this;for(var t in HallCmdDef){var r=t;if(isNaN(r)){var a=HallCmdDef[t],n=a,o=e[e.funcPrefix+n];o&&e.unRegisterFunction(n)}}},t.prototype.method_100=function(e){ErrorMananger.getInstance().checkReqResult(e)||console.log(e)},t.prototype.method_103=function(e){if(!ErrorMananger.getInstance().checkReqResult(e)){console.log(e);var t=UIManager.getInstance().getViewByName(MallView);t&&t.recvData(HallCmdDef.CMD_GET_MOLL_CONFIG,e.msg)}},t.prototype.method_104=function(e){if(!ErrorMananger.getInstance().checkReqResult(e)){console.log(e);var t=UIManager.getInstance().getViewByName(MallView);t&&t.recvData(HallCmdDef.CMD_GET_MOLLBY_CONFIG,e);var r=UIManager.getInstance().getViewByName(HallView);r&&r.recvData(HallCmdDef.CMD_GETUPADTEGOLD,e)}},t.prototype.method_105=function(e){if(!ErrorMananger.getInstance().checkReqResult(e)){console.log(e);var t=UIManager.getInstance().getViewByName(PackageView);t&&t.recvData(HallCmdDef.CMD_Bag,e.msg)}},t.prototype.method_106=function(e){if(!ErrorMananger.getInstance().checkReqResult(e)){console.log(e);var t=UIManager.getInstance().getViewByName(PackageView);t&&t.recvData(HallCmdDef.CMD_Baguse,e);var r=UIManager.getInstance().getViewByName(CardOperationView);r&&r.recvData(HallCmdDef.CMD_Baguse,e)}},t.prototype.method_216=function(e){if(!ErrorMananger.getInstance().checkReqResult(e)){console.log(e);var t=UIManager.getInstance().getViewByName(CardOperationView);t&&t.recvData(HallCmdDef.CMD_BaguseUp,e)}},t.prototype.method_206=function(e){if(!ErrorMananger.getInstance().checkReqResult(e)){console.log(e);var t=UIManager.getInstance().getViewByName(PackageView);t&&t.recvData(HallCmdDef.CMD_BagDestory,e)}},t.prototype.method_107=function(e){if(!ErrorMananger.getInstance().checkReqResult(e)){console.log(e);
var t=UIManager.getInstance().getViewByName(HallView);t&&t.recvData(HallCmdDef.CMD_Notice,e)}},t.prototype.method_208=function(e){if(!ErrorMananger.getInstance().checkReqResult(e)){console.log(e);var t=UIManager.getInstance().getViewByName(CombatRecordView);t&&t.recvData(HallCmdDef.CMD_Record,e)}},t.prototype.method_125=function(e){if(!ErrorMananger.getInstance().checkReqResult(e)){console.log(e);var t=UIManager.getInstance().getViewByName(ExtractView);t&&t.recvData(HallCmdDef.CMD_Award,e)}},t.prototype.method_126=function(e){if(!ErrorMananger.getInstance().checkReqResult(e)){console.log(e);var t=UIManager.getInstance().getViewByName(ChouCardView);t&&t.recvData(HallCmdDef.CMD_Award10,e)}},t.prototype.method_127=function(e){if(!ErrorMananger.getInstance().checkReqResult(e)){console.log(e);var t=UIManager.getInstance().getViewByName(ChouCardView);t&&t.recvData(HallCmdDef.CMD_MyCardList,e);var r=UIManager.getInstance().getViewByName(ExtractView);r&&r.recvData(HallCmdDef.CMD_MyCardList,e);var a=UIManager.getInstance().getViewByName(HallView);a&&a.recvData(HallCmdDef.CMD_GETUPADTEGOLD,e)}},t.prototype.method_129=function(e){ErrorMananger.getInstance().checkReqResult(e)||console.log(e)},t.prototype.method_110=function(e){if(!ErrorMananger.getInstance().checkReqResult(e)){var t=UIManager.getInstance().getViewByName(CardGroupView);t&&t.recvData(HallCmdDef.CMD_GET_TEAM_CONFIG,e.msg)}},t.prototype.method_111=function(e){if(!ErrorMananger.getInstance().checkReqResult(e)){var t=UIManager.getInstance().getViewByName(CardGroupView);t&&t.recvData(HallCmdDef.CMD_GET_TEAM_LIST,e.msg)}},t.prototype.method_112=function(e){if(!ErrorMananger.getInstance().checkReqResult(e)){var t=UIManager.getInstance().getViewByName(CardGroupView);t&&t.recvData(HallCmdDef.CMD_CHANGE_BATTLE_TEAM,e.msg)}},t.prototype.method_113=function(e){if(!ErrorMananger.getInstance().checkReqResult(e)){console.log(e);var t=UIManager.getInstance().getViewByName(CardGroupSetView);t&&t.recvData(HallCmdDef.CMD_GET_CARD_LIST_TEAMSET,e.msg)}},t.prototype.method_228=function(e){if(!ErrorMananger.getInstance().checkReqResult(e)){console.log(e);var t=UIManager.getInstance().getViewByName(CardView);t&&t.recvData(HallCmdDef.CMD_CardWiewLists,e.msg)}},t.prototype.method_114=function(e){if(!ErrorMananger.getInstance().checkReqResult(e)){console.log(e);var t=UIManager.getInstance().getViewByName(CardGroupSetView);t&&t.recvData(HallCmdDef.CMD_GET_CARD_DETAIL_TEAMSET,e.msg);var r=UIManager.getInstance().getViewByName(CardView);r&&r.recvData(HallCmdDef.CMD_GET_CARD_DETAIL_TEAMSET,e.msg)}},t.prototype.method_115=function(e){if(!ErrorMananger.getInstance().checkReqResult(e)){var t=UIManager.getInstance().getViewByName(CardGroupSetView);t&&t.recvData(HallCmdDef.CMD_SAVE_TEAMSET,e.msg)}},t.prototype.method_116=function(e){if(!ErrorMananger.getInstance().checkReqResult(e)){var t=UIManager.getInstance().getViewByName(CardGroupView);t&&t.recvData(HallCmdDef.CMD_GET_FROM_FETTER_TEAM,e.msg)}},t.prototype.method_117=function(e){if(!ErrorMananger.getInstance().checkReqResult(e)){var t=UIManager.getInstance().getViewByName(CardGroupSetView);t&&t.recvData(HallCmdDef.CMD_GET_FROM_FETTER_TEAMSET,e.msg)}},t.prototype.method_124=function(e){if(!ErrorMananger.getInstance().checkReqResult(e)){var t=UIManager.getInstance().getViewByName(CardView);t&&t.recvData(HallCmdDef.CMD_GET_CARD_DETAIL,e.msg)}},t.prototype.method_128=function(e){if(!ErrorMananger.getInstance().checkReqResult(e)){var t=UIManager.getInstance().getViewByName(SetView);t&&t.recvData(HallCmdDef.CMD_SetConfig,e.msg)}},t.prototype.method_150=function(e){if(!ErrorMananger.getInstance().checkReqResult(e)){var t=UIManager.getInstance().getViewByName(CardView);t&&t.recvData(HallCmdDef.CMD_GET_CARD_LIST,e.msg)}},t.prototype.method_151=function(e){if(!ErrorMananger.getInstance().checkReqResult(e)){var t=UIManager.getInstance().getViewByName(CardView);t&&t.recvData(HallCmdDef.CMD_GET_CARD_DETAIL,e.msg)}},t.prototype.method_160=function(e){if(!ErrorMananger.getInstance().checkReqResult(e)){for(var t=GlobalDataManager.getInstance().getJiBanData(),r=e.msg.length,a=0;r>a;a++){var n=e.msg[a];t.setJBnode(n.code,n.jbName,n.zc)}var o=UIManager.getInstance().getViewByName(FettersView);o&&o.recvData(HallCmdDef.CMD_GET_FETTERS_CONFIG,e.msg)}},t.prototype.method_180=function(e){var t=UIManager.getInstance().getViewByName(MatchingView);t&&t.recvData(HallCmdDef.CMD_MATCH_PVP,e)},t.prototype.method_181=function(e){if(!ErrorMananger.getInstance().checkReqResult(e)){var t=UIManager.getInstance().getViewByName(MatchingView);t&&t.recvData(HallCmdDef.CMD_DISMATCH_PVP,e.msg)}},t.prototype.method_182=function(e){var t=UIManager.getInstance().getViewByName(MatchingView);t&&t.recvData(HallCmdDef.CMD_GET_MATCH_PVP_INFO,e)},t.prototype.method_183=function(e){if(!ErrorMananger.getInstance().checkReqResult(e)){var t=UIManager.getInstance().getViewByName(HallView);t&&t.recvData(HallCmdDef.CMD_HALL_GET_MATCH_PVP_INFO,e.msg)}},t.prototype.method_200=function(e){if(!ErrorMananger.getInstance().checkReqResult(e)){var t=UIManager.getInstance().getViewByName(RoleUpgradeView);t&&t.recvData(HallCmdDef.CMD_UPGRADE_COMMANDER,e.msg)}},t.prototype.method_201=function(e){if(!ErrorMananger.getInstance().checkReqResult(e)){var t=UIManager.getInstance().getViewByName(RoleUpgradeView);t&&t.recvData(HallCmdDef.CMD_GET_UPGRADE_MATERIAL_LIST,e.msg)}},t}(BaseDecoder);__reflect(HallDecoder.prototype,"HallDecoder");var ChouCardView=function(e){function t(){var r=e.call(this,t.NAME)||this;return r.arrCardFetters=new Array,r.mallName=[],r}return __extends(t,e),t.prototype.week=function(){var e=this;e.hasEventListener(egret.TouchEvent.TOUCH_TAP)||e.addEventListener(egret.TouchEvent.TOUCH_TAP,e.touchTap,e),e.tittle1.$setVisible(!1)},t.prototype.sleep=function(){this.cleanArray(this.arrCardFetters)},t.prototype.recvData=function(e,t){var r=this;switch(e){case HallCmdDef.CMD_Award10:case HallCmdDef.CMD_MyCardList:for(var a=(t.msg,t.msg.length),n=0;a>n;n++){var o=t.msg[n];r.mallName[n]=o}0>=a?r.tittle1.$setVisible(!0):r.setCardItem()}},t.prototype.setCardItem=function(){for(var e=this.panel.width/5,t=40,r=this.mallName.length,a=.4,n=0;r>n;n++){var o=new CardRectangleView,i=this.mallName[n],l={icon:i.iconUrl,rarity:i.rarity,element:i.ele,round:i.round,generation:i.generation,name:i.name,cost:i.cost,level:i.level,atk:i.atk,hp:i.hp,groupName:i.groupname,canTouch:!0};o.initData(l),o.scaleX=a,o.scaleY=a;var s=r/2;s>n?(o.x=.2*e+e*n,o.y=t):(o.x=.2*e+e*(n-s),o.y=t+o.height*a+30),this.panel.addChild(o),this.arrCardFetters.push(o)}},t.prototype.cleanArray=function(e){if(!(null==e||e.length<=0))for(var t=e.length-1;t>=0;t--){var r=e[t];if(null!=r){var a=r.parent;a.removeChild(r)}e.splice(t,1)}},t.prototype.touchTap=function(e){var t=this,r=e.target;if(r instanceof eui.Button){if(r==t.btnConfirm){t.hiden(),console.log("确定被按下");var a=new Object;a.param="抽奖";var n=GlobalDataManager.getInstance().getCenterServer();HttpManager.getInstance().send(n.getSname(),HallCmdDef.CMD_Award,a,!0)}else if(r==t.btnCancel){this.cleanArray(this.arrCardFetters);var a=new Object;a.param="十连抽抽奖按钮",a.pageid="1",a.pageSize="9";var n=GlobalDataManager.getInstance().getCenterServer();HttpManager.getInstance().send(n.getSname(),HallCmdDef.CMD_MyCardList,a,!0)}}else r instanceof eui.Rect&&r==t.rectBG},t.NAME="ChouCardSkin",t}(BaseView);__reflect(ChouCardView.prototype,"ChouCardView");var ECardItemView=function(e){function t(){var r=e.call(this,t.NAME)||this;return r.arrLetter=["a","b","c","d","e","f","g"],r}return __extends(t,e),t.prototype.week=function(){var t=this,r=e.prototype.getData.call(this);if(null!=r){var a=(r.own,r.index),n=r.obj,o={icon:n.icon,rarity:n.rarity,element:n.element,round:n.round,generation:n.generation,name:n.name,cost:n.cost,level:n.level,atk:n.atk,hp:n.hp,groupName:"groupCR_"+a,canTouch:!0};this.setSCard(o),1==n.cantouch?t.groupNotOwn.visible=!1:t.groupNotOwn.visible=!0}},t.prototype.setSCard=function(e){var t=this,r=new CardSquareView;r.initData(e),r.scaleX=Number((t.groupCard.width/r.width).toFixed(2)),r.scaleY=Number((t.groupCard.height/r.height).toFixed(2)),r.showSimple(),t.groupCard.addChild(r)},t.prototype.sleep=function(){},t.prototype.setImgBG=function(e){var t=this;t.imgBG.source="lobbyImg1Sheet_json."+t.arrLetter[e-1]+"196x194"},t.prototype.getViewWidth=function(){return this.groupCI.width},t.prototype.getViewHeight=function(){return this.groupCI.height},t.prototype.showSimple=function(){},t.NAME="ECardItemSkin",t}(BaseView);__reflect(ECardItemView.prototype,"ECardItemView");var ExtrackInfoView=function(e){function t(){var r=e.call(this,t.NAME)||this;return r.bagid=0,r}return __extends(t,e),t.prototype.week=function(){var t=this,t=this,r=e.prototype.getData.call(this);null!=r&&(t.puotngstring.text=r.common+"%",t.xiyoustring.text=r.rare+"%",t.shishistring.text=r.epic+"%",t.chuanqistring.text=r.legendary+"%",t.shenhuagstring.text=r.mythical+"%",t.hasEventListener(egret.TouchEvent.TOUCH_TAP)||t.addEventListener(egret.TouchEvent.TOUCH_TAP,t.touchTap,t))},t.prototype.sleep=function(){},t.prototype.touchTap=function(e){var t=this,r=e.target;r instanceof eui.Button&&r==t.btnCancel&&t.hiden()},t.NAME="ExtrackInfoSkin",t}(BaseView);__reflect(ExtrackInfoView.prototype,"ExtrackInfoView");var ExtractView=function(e){function t(){var r=e.call(this,t.NAME)||this;return r.mallName=[],r.rarityConfigList=[],r.arrCardItem=new Array,r.movingState=!1,r}return __extends(t,e),t.prototype.week=function(){var e=this;e.hasEventListener(egret.TouchEvent.TOUCH_TAP)||e.addEventListener(egret.TouchEvent.TOUCH_TAP,e.touchTap,e),e.scrCardItem.addEventListener(egret.TouchEvent.TOUCH_CANCEL,e.onCancelHandler,e),e.scrCardItem.addEventListener(egret.TouchEvent.TOUCH_END,e.onEndHandler,e),e.updateGold(0),e.sendGetAwardList()},t.prototype.onCancelHandler=function(){this.movingState=!0},t.prototype.onEndHandler=function(){this.movingState=!1},t.prototype.sendGetAwardList=function(){var e=new Object;e.param="抽奖";var t=GlobalDataManager.getInstance().getCenterServer();HttpManager.getInstance().send(t.getSname(),HallCmdDef.CMD_Award,e,!0)},t.prototype.recvData=function(e,t){var r=this;switch(e){case HallCmdDef.CMD_Award:for(var a=(t.msg,t.msg.length),n=0;a>n;n++){var o=t.msg[n],i=o.awardId;r.mallName[i-1]=o}r.tittleObj=t.tittleconfig[0],r.rarityConfigList.length=t.rarityConfigList.length;for(var l=0;l<t.rarityConfigList.length;l++){var s=t.rarityConfigList[l].code;r.rarityConfigList[s]=t.rarityConfigList[l].rate}r.updateGold(r.tittleObj.cost),a>0&&(r.setTittle(),r.setCardItem());break;case HallCmdDef.CMD_MyCardList:var c=t.curGold,p=GlobalDataManager.getInstance().getAccountData();p.setGold(c)}},t.prototype.updateGold=function(e){this.comStar.txt.text=e},t.prototype.setTittle=function(){this.tittle1.text=this.tittleObj.tittle1,this.tittle2.text=this.tittleObj.tittle2},t.prototype.onLoadImgCompleteHandler=function(e){if(e.currentTarget.data){var t=new egret.Texture;t.bitmapData=e.currentTarget.data;var r=new egret.Bitmap(t);r.x=0,r.y=0,r.width=this.groupCardItem0.width,r.height=this.groupCardItem0.height,this.groupCardItem0.addChild(r)}},t.prototype.sleep=function(){var e=this;e.cleanArray(e.arrCardItem)},t.prototype.cleanArray=function(e){if(!(null==e||e.length<=0))for(var t=e.length-1;t>=0;t--){var r=e[t];if(null!=r){var a=r.parent;a.removeChild(r)}e.splice(t,1)}},t.prototype.touchTap=function(e){var t=this,r=e.target.name;if("groupCR_"==r.substr(0,8)){if(t.movingState)return;var a=r.substr(8,3);UIManager.getInstance().showUI(CGAwardView,GameScene.VIEW_LAYER_NUMBER,-1,0,0,0,t.mallName[a])}if(e.target instanceof eui.Button){var n=e.target;if(n==t.btnBuy){var o=GlobalDataManager.getInstance().getAccountData();if(o.gold<100)PopManager.getInstance().showPromptBox("金币不够",2,Handler.create(t,function(e){console.log("回调函数被调用")}));else{UIManager.getInstance().showUI(ChouCardView);var i=0;if(1==i){var l=new Object;l.poolNum="1000";var s=GlobalDataManager.getInstance().getCenterServer();HttpManager.getInstance().send(s.getSname(),HallCmdDef.CMD_CreateCardPool,l,!0)}else{var l=new Object;l.param="十连抽抽奖按钮",l.pageid="1",l.pageSize="9";var s=GlobalDataManager.getInstance().getCenterServer();HttpManager.getInstance().send(s.getSname(),HallCmdDef.CMD_MyCardList,l,!0)}}}else n==t.btnBack?t.hiden():n==t.btnInfo&&t.rarityConfigList.length>=5&&UIManager.getInstance().showUI(ExtrackInfoView,GameScene.VIEW_LAYER_NUMBER,-1,0,0,0,t.rarityConfigList)}},t.prototype.setCardItem=function(){for(var e=this,t=5,r=0,a=e.scrCardItem.width/t,n=0,o=e.mallName.length,i=0;o>i;i++){var l=new ECardItemView,s=e.mallName[i];l.initData({own:i%2==0?1:0,index:i,obj:s}),l.name=i.toString(),e.groupCardItem.addChild(l),l.x=r*a,l.y=n*(l.getViewHeight()+10),l.width=l.getViewWidth(),l.height=l.getViewHeight(),e.arrCardItem.push(l),r++,r>=t&&(r=0,n++)}},t.prototype.onResize=function(t){e.prototype.onResize.call(this,t);var r=this;if(null!=r.extractskingroup){var a=GlobalDef.SCREEN_WIDTH>GlobalDef.SCREEN_HEIGHT?GlobalDef.SCREEN_WIDTH:GlobalDef.SCREEN_HEIGHT,n=GlobalDef.SCREEN_WIDTH>GlobalDef.SCREEN_HEIGHT?GlobalDef.SCREEN_HEIGHT:GlobalDef.SCREEN_WIDTH,o=r.$stage.stageWidth,i=r.$stage.stageHeight,l=Number((o/i/(a/n)).toFixed(2));return l>1||0>l?void(r.extractskingroup.scaleX=r.extractskingroup.scaleY=1):void(r.extractskingroup.scaleX=r.extractskingroup.scaleY=l)}},t.NAME="ExtractSkin",t}(BaseView);__reflect(ExtractView.prototype,"ExtractView");var DailogView=function(e){function t(){var r=e.call(this,t.NAME)||this;return r.func=null,r}return __extends(t,e),t.prototype.week=function(){var t=this;t.hasEventListener(egret.TouchEvent.TOUCH_TAP)||t.addEventListener(egret.TouchEvent.TOUCH_TAP,t.touchTap,t);var r=e.prototype.getData.call(this);if(null!=r){var a=r.name;this.func=r.fun,t.showTxt.text=a}},t.prototype.sleep=function(){},t.prototype.SetTxt=function(e){this.showTxt.text=e},t.prototype.touchTap=function(e){var t=this,r=e.target;r instanceof eui.Button?r==t.btnConfirm?(t.hiden(),null!=this.func&&this.func()):r==t.btnCancel&&(t.hiden(),console.log("取消被按下")):r instanceof eui.Rect&&r==t.rectBG&&t.hiden()},t.NAME="DailogSkin",t}(BaseView);__reflect(DailogView.prototype,"DailogView");var DailogView2=function(e){function t(){var r=e.call(this,t.NAME)||this;return r.func=null,r}return __extends(t,e),t.prototype.week=function(){var t=this;t.hasEventListener(egret.TouchEvent.TOUCH_TAP)||t.addEventListener(egret.TouchEvent.TOUCH_TAP,t.touchTap,t);var r=e.prototype.getData.call(this);if(null!=r){var a=r.name;this.func=r.fun,t.showTxt.text=a}},t.prototype.sleep=function(){},t.prototype.SetTxt=function(e){this.showTxt.text=e},t.prototype.touchTap=function(e){var t=this,r=e.target;r instanceof eui.Button?r==t.btnConfirm?(t.hiden(),null!=this.func&&this.func()):r==t.btnCancel&&(t.hiden(),console.log("取消被按下")):r instanceof eui.Rect&&r==t.rectBG&&t.hiden()},t.NAME="DailogSkin2",t}(BaseView);__reflect(DailogView2.prototype,"DailogView2");var HallHeadView=function(e){function t(){return e.call(this,LoadingView.NAME)||this}return __extends(t,e),t.prototype.week=function(){var e=this;e.nickname1.text="123"},t.prototype.setNickName=function(e){},t.prototype.sleep=function(){},t.NAME="HeadSkin",t}(BaseView);__reflect(HallHeadView.prototype,"HallHeadView");var HallView=function(e){function t(){return e.call(this,t.NAME)||this}return __extends(t,e),t.prototype.$onAddToStage=function(t,r){e.prototype.$onAddToStage.call(this,t,r),Hall.onGameShow()},t.prototype.week=function(){var e=this;e.hasEventListener(egret.TouchEvent.TOUCH_TAP)||e.addEventListener(egret.TouchEvent.TOUCH_TAP,e.touchTap,e),t.arrMsg=new Array;var r=GlobalDataManager.getInstance().getAccountData();e.comHead.nickname.text=r.getNick().substring(0,7),e.comHead.prbLoading0.value=100,e.onUpdateAccountData(),e.updateGold();var a=r.getHead_Url();if(null!=a&&""!=a){var n=new egret.ImageLoader;egret.ImageLoader.crossOrigin="anonymous",n.load(a),n.once(egret.Event.COMPLETE,e.onLoadImgCompleteHandler,e),n.once(egret.IOErrorEvent.IO_ERROR,function(e){console.log("加载网络图片:"+a+" 出现错误!")},e)}var o=new Object;o.param="跑马灯";var i=GlobalDataManager.getInstance().getCenterServer();HttpManager.getInstance().send(i.getSname(),HallCmdDef.CMD_Notice,o,!1),e.startTimer()},t.prototype.updateHead=function(){var e=this,t=GlobalDataManager.getInstance().getAccountData();e.comHead.nickname.text=t.getNick().substring(0,7),e.comHead.leveltxt.text=t.getLvl()+"";var r=t.getUpexp(),a=t.getMuexp();e.comHead.lblProgress.text=r+""+a,e.comHead.prbLoading.value=r/a*100,e.comHead.hptxt.text=t.getHp()+"",e.comHead.prbLoading0.value=1},t.prototype.updateGold=function(){var e=GlobalDataManager.getInstance().getAccountData();this.comStar.txt.text=e.gold},t.prototype.startTimer=function(){var e=this;null==e.timer&&(e.timer=new egret.Timer(3e5,0),e.timer.addEventListener(egret.TimerEvent.TIMER,e.timerFunc,e)),e.timer.start()},t.prototype.stopTimer=function(){var e=this;null!=e.timer&&e.timer.stop()},t.prototype.timerFunc=function(){var e=new Object;e.param="跑马灯";var t=GlobalDataManager.getInstance().getCenterServer();HttpManager.getInstance().send(t.getSname(),HallCmdDef.CMD_Notice,e,!1)},t.prototype.onLoadImgCompleteHandler=function(e){var t=this;if(e.currentTarget.data){var r=new egret.Texture;r.bitmapData=e.currentTarget.data;var a=new egret.Bitmap(r);a.x=0,a.y=0,a.width=t.comHead.groupIcon.width,a.height=t.comHead.groupIcon.height,t.comHead.groupIcon.addChild(a);var n=new egret.Shape;n.graphics.beginFill(0);var o=t.comHead.groupIcon.width/2,i=t.comHead.groupIcon.height/2;n.x=o,n.y=i,n.graphics.drawCircle(0,0,o),n.graphics.endFill(),t.comHead.groupIcon.addChild(n),a.mask=n}},t.prototype.sleep=function(){this.stopTimer()},t.prototype.recvData=function(e,r){var a=this;switch(e){case HallCmdDef.CMD_Notice:;t.arrMsg=[];for(var n=r.msg.length,o=0;n>o;o++){var i={nna:r.msg[o].tittle+": ",nde:r.msg[o].disc};t.arrMsg.push(i)}a.showHorseRaceLamp();break;case HallCmdDef.CMD_GETUPADTEGOLD:a.updateGold()}},t.prototype.touchTap=function(e){var t=this,r=e.target;if(r instanceof eui.Button)if(r==t.btnCard){UIManager.getInstance().showUI(CardView);var a=new Object;a.param="卡牌"}else r==t.btnCombat?UIManager.getInstance().showUI(MatchingView):r==t.btnCardGroup?UIManager.getInstance().showUI(CardGroupView):r==t.btnExtract?UIManager.getInstance().showUI(ExtractView):r==t.btnMall?UIManager.getInstance().showUI(MallView):r==t.btnPackage?UIManager.getInstance().showUI(PackageView):r==t.btnActivity?PopManager.getInstance().showPromptBox("暂未开放",2,Handler.create(t,function(e){console.log("回调函数被调用")})):r==t.btnFetters?UIManager.getInstance().showUI(FettersView):r==t.btnCombatRecord?UIManager.getInstance().showUI(CombatRecordView):r==t.btnSetUp?UIManager.getInstance().showUI(SetView):(r==t.HeadButton||r==t.comHead.upbtn)&&UIManager.getInstance().showUI(RoleUpgradeView,GameScene.VIEW_LAYER_NUMBER,-1,0,0,0,{callBackHandler:Handler.create(t,t.onUpdateAccountData,null,!1)})},t.prototype.showHorseRaceLamp=function(){HorseRaceLamp.getInstance().closeHorseRaceLamp();for(var e=0;e<t.arrMsg.length;e++){var r=t.arrMsg[e],a=r.nna,n=r.nde,o=18,i=!1,l=165,s=80,c=new eui.Label;c.x=10,c.y=0,c.fontFamily="SimHei",c.size=o,c.bold=i,c.text=a+n;var p=1e4,u=this.comNotable.width-s-l;u=1>u?1:u,p+=p*(c.width/u),HorseRaceLamp.getInstance().showHorseRaceLamp(this.comNotable,r.nna+r.nde,8,l,s,!1,p,16769965,o,i,2,1500,null,!0)}},t.prototype.reqMatchInfo=function(){var e=GlobalDataManager.getInstance().getCenterServer();HttpManager.getInstance().send(e.getSname(),HallCmdDef.CMD_HALL_GET_MATCH_PVP_INFO,{},!1)},t.prototype.onUpdateAccountData=function(){var e=this,t=GlobalDataManager.getInstance().getAccountData();e.comHead.leveltxt.text=t.getLvl()+"";var r=t.getExp(),a=t.getUpexp();e.comHead.lblProgress.text=r+"/"+a,e.comHead.prbLoading.value=r/a*100,e.comHead.hptxt.text=t.getHp()+""},t.NAME="HallSkin",t}(BaseView);__reflect(HallView.prototype,"HallView");var HorseRaceLamp=function(){function e(){this.objHorseRaceLamp=new Array,this.isHRL=!1}return e.getInstance=function(){return e.m_manager},e.prototype.showHorseRaceLamp=function(e,t,r,a,n,o,i,l,s,c,p,u,h,d){void 0===r&&(r=10),void 0===a&&(a=165),void 0===n&&(n=100),void 0===o&&(o=!1),void 0===i&&(i=1e4),void 0===l&&(l=16777215),void 0===s&&(s=18),void 0===c&&(c=!1),void 0===p&&(p=2),void 0===u&&(u=1500),void 0===h&&(h=null),void 0===d&&(d=!1);var g=new Object;g.txt=t,g.offY=r,g.left=a,g.right=n,g.color=l,g.speed=i,g.size=s,g.stroke=p,g.bold=c,g.container=e,g.mask=h,g.wait=u,g.loop=d,o?this.OutHorseRaceLamp(g):(this.objHorseRaceLamp.push(g),this.isHRL||this.OutHorseRaceLamp())},e.prototype.closeHorseRaceLamp=function(){for(this.HorseM&&this.HorseM.parent&&this.HorseM.parent.removeChild(this.HorseM),this.HorseBG&&(egret.Tween.removeTweens(this.HorseBG),this.HorseBG.parent&&this.HorseBG.parent.removeChild(this.HorseBG));this.objHorseRaceLamp.length;)this.objHorseRaceLamp.pop();this.isHRL=!1},e.prototype.OutHorseRaceLamp=function(e){void 0===e&&(e=null);var t=null;if(null==e){if(this.isHRL)return;if(0==this.objHorseRaceLamp.length)return;t=this.objHorseRaceLamp.shift()}else t=e;var r=t.textFlow,a=t.txt,n=t.offY,o=t.left,i=t.right,l=t.speed,s=t.color,c=t.size,p=t.bold,u=t.stroke,h=t.container,d=t.mask,g=t.wait,m=t.loop;if(m&&this.objHorseRaceLamp.push(t),h){if(!h.stage)return void egret.Tween.get(h).wait(1e3).call(function(){this.OutHorseRaceLamp(null)},this,null);var C=new eui.Label;C.x=0,C.y=0,C.touchEnabled=!1,void 0==r?(C.fontFamily="SimHei",C.size=c,C.textColor=s,C.bold=p,C.text=a,C.stroke=u):C.textFlow=r;var f=new egret.Sprite;f.graphics.beginFill(0,0),f.addChild(C),f.graphics.drawRect(0,0,C.width,C.height),f.y=n,f.x=h.stage.stageWidth,f.touchEnabled=!1,f.mask=d;var v=null;null==d&&0!=o&&0!=i&&(v=new eui.Rect,v.left=o,v.right=i,v.height=C.height,v.fillColor=0,v.y=n,f.mask=v,v.y=n,h.addChild(v),this.HorseM&&this.HorseM.parent&&this.HorseM.parent.removeChild(this.HorseM),this.HorseM=v),h.addChild(f),this.HorseBG&&this.HorseBG.parent&&this.HorseBG.parent.removeChild(this.HorseBG),this.HorseBG=f,null==e&&(this.isHRL=!0);var I=h.width-o-i,y=C.width>I?I+o-C.width:o,w=h.width+C.width+20,E=l*(h.width-y+o)/w;E=E>l?l/2:E,egret.Tween.get(f).to({x:y},E).wait(g).to({x:0-C.width-20},l-E).call(function(e,t,r){e.parent&&(e.parent.removeChild(e),this.HorseBG=null),r&&(this.isHRL=!1,this.OutHorseRaceLamp(null)),t&&t.parent&&(t.parent.removeChild(t),this.HorseM=null)},this,[f,v,null==e?!0:!1])}},e.m_manager=new e,e}();__reflect(HorseRaceLamp.prototype,"HorseRaceLamp");var LoadingView=function(e){function t(){return e.call(this,t.NAME)||this}return __extends(t,e),t.prototype.week=function(){var e=this;e.hasEventListener(egret.TouchEvent.TOUCH_TAP)||e.addEventListener(egret.TouchEvent.TOUCH_TAP,e.touchTap,e),this.timer=new egret.Timer(200,0),this.timer.addEventListener(egret.TimerEvent.TIMER,this.timerFunc,this),this.timer.start(),this.loadNum=0},t.prototype.sleep=function(){},t.prototype.timerFunc=function(){this.loadNum=this.loadNum+1,this.loadNum>=100&&(this.timer.stop(),this.timer.removeEventListener(egret.TimerEvent.TIMER,this.timerFunc,this),this.hiden())},t.prototype.touchTap=function(e){var t=this,r=e.target;r instanceof eui.Button&&t.hiden()},t.NAME="LoadingSkin",t}(BaseView);__reflect(LoadingView.prototype,"LoadingView");var LobbyTestView=function(e){function t(){return e.call(this,t.NAME)||this}return __extends(t,e),t.prototype.$onAddToStage=function(t,r){e.prototype.$onAddToStage.call(this,t,r),Hall.onGameShow()},t.prototype.week=function(){var e=this;e.hasEventListener(egret.TouchEvent.TOUCH_TAP)||e.addEventListener(egret.TouchEvent.TOUCH_TAP,e.touchTap,e),t.arrMsg=new Array;var r={nna:"标题:",nde:"内容内容内容内容内容内容内容内容66"};t.arrMsg.push(r)},t.prototype.sleep=function(){},t.prototype.recvData=function(e){},t.prototype.touchTap=function(e){var r=this,a=e.target;a instanceof eui.Button&&a==r.BtnZhuXiao&&UIManager.getInstance().showUI(t,GameScene.VIEW_LAYER_NUMBER,-1,0,0,0,{})},t.NAME="SetSkin",t}(BaseView);__reflect(LobbyTestView.prototype,"LobbyTestView");var NotableView=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(BaseView);__reflect(NotableView.prototype,"NotableView");var RoleUpgradeMaterialView=function(e){function t(){return e.call(this,t.NAME)||this}return __extends(t,e),t.prototype.week=function(){var t=this;t.imgIcon.source="",t.lblCount.text="",t.imgSelect.visible=!1,t.lblName.text="",t.count=0,t.kind="";var r=e.prototype.getData.call(this);if(null!=r){var a=r.mdata;null!=a&&(null!=a.icon&&(t.imgIcon.source="hallImg1Sheet_json."+a.icon),null!=a.count&&(t.count=a.count,t.lblCount.text=a.count),null!=a.name&&(t.lblName.text=a.name),null!=a.kind&&(t.kind=a.kind)),null!=r.gname&&(t.groupRUM.name=r.gname)}},t.prototype.sleep=function(){},t.prototype.setSelect=function(e){this.imgSelect.visible=e},t.prototype.setCount=function(e){var t=this;t.count=e,t.lblCount.text=e+"",0==e&&t.setSelect(!1)},t.prototype.getCount=function(){return this.count},t.prototype.getKind=function(){return this.kind},t.prototype.getViewWidth=function(){return this.groupRUM.width},t.NAME="RoleUpgradeMaterialSkin",t}(IBaseView);__reflect(RoleUpgradeMaterialView.prototype,"RoleUpgradeMaterialView");var RoleUpgradeView=function(e){function t(){return e.call(this,t.NAME)||this}return __extends(t,e),t.prototype.week=function(){var t=this;t.hasEventListener(egret.TouchEvent.TOUCH_TAP)||t.addEventListener(egret.TouchEvent.TOUCH_TAP,t.touchTap,t),t.groupUpgrade.visible=!0,t.groupLevelUp.visible=!1,t.upgradeMaterialViewArr=new Array,t.updateView(),t.reqUpgradeMaterialList();var r=e.prototype.getData.call(this);null!=r&&(t.callBackHandler=r.callBackHandler)},t.prototype.sleep=function(){var e=this;e.hasEventListener(egret.TouchEvent.TOUCH_TAP)&&e.removeEventListener(egret.TouchEvent.TOUCH_TAP,e.touchTap,e),e.cleanUpgradeMaterialViewArr()},t.prototype.touchTap=function(e){var t=this,r=e.target;if(r instanceof eui.Button){var a=r;if(a==t.btnUCancel)t.hiden();else if(a==t.btnUUser){if(null==t.curSelMaterialView)return void PopManager.getInstance().showPromptBox("药品不足,请前往商城购买!",2,Handler.create(t,function(e){t.hiden(),UIManager.getInstance().showUI(MallView)}));var n=GlobalDataManager.getInstance().getCenterServer();HttpManager.getInstance().send(n.getSname(),HallCmdDef.CMD_UPGRADE_COMMANDER,{kind:t.curSelMaterialView.getKind()},!0)}else a==t.btnClose?t.hiden():a==t.btnGoShop&&(t.hiden(),UIManager.getInstance().showUI(MallView))}else if(r instanceof eui.Rect)r==t.rectBG&&t.hiden();else if(r instanceof eui.Group){var o=e.target;if("groupRUM_"==o.name.substr(0,9)){var i=o.name.split("_");if(2!=i.length)return;var l=Number(i[1]),s=t.upgradeMaterialViewArr[l];if(null==s||s==t.curSelMaterialView||s.getCount()<=0)return;null!=t.curSelMaterialView&&t.curSelMaterialView.setSelect(!1),s.setSelect(!0),t.curSelMaterialView=s}}},t.prototype.recvData=function(e,t){var r=this;switch(e){case HallCmdDef.CMD_UPGRADE_COMMANDER:r.onUpgradeCommander(t);break;case HallCmdDef.CMD_GET_UPGRADE_MATERIAL_LIST:r.onGetUpgradeMaterialList(t)}},t.prototype.updateView=function(){var e=this,t=GlobalDataManager.getInstance().getAccountData();e.lblLvl.text=t.getLvl()+"",e.lblLvProgress.text=t.getExp()+"/"+t.getUpexp(),e.groupGoShop.visible=!0},t.prototype.reqUpgradeMaterialList=function(){var e=GlobalDataManager.getInstance().getCenterServer();HttpManager.getInstance().send(e.getSname(),HallCmdDef.CMD_GET_UPGRADE_MATERIAL_LIST,{},!0)},t.prototype.onUpgradeCommander=function(e){if(null!=e){var t=this,r=e.lvl,a=e.exp,n=e.upexp,o=e.hp,i=e.count,l=e.kind,s=GlobalDataManager.getInstance().getAccountData();if(null!=r&&s.setLvl(r),null!=a&&s.setExp(a),null!=n&&s.setUpexp(n),null!=o&&s.setHp(o),null!=i&&null!=l)for(var c=0,p=t.upgradeMaterialViewArr.length;p>c;c++){var u=t.upgradeMaterialViewArr[c];null!=u&&u.getKind()==l+""&&(u.setCount(i),0==i&&t.curSelMaterialView==u&&(t.curSelMaterialView=null))}t.updateView(),PopManager.getInstance().showPromptBox("使用成功!",2),null!=t.callBackHandler&&t.callBackHandler.run()}},t.prototype.onGetUpgradeMaterialList=function(e){if(null!=e){var t=this;t.cleanUpgradeMaterialViewArr();for(var r=50,a=0,n=0,o=e.length;o>n;n++){var i=e[n];if(null!=i){var l=new RoleUpgradeMaterialView;l.initData({mdata:i,gname:"groupRUM_"+n}),t.groupUMaterial.addChild(l),l.x=n*(l.getViewWidth()+r),null!=i.count&&(a+=i.count,null==t.curSelMaterialView&&0!=i.count&&(t.curSelMaterialView=l,l.setSelect(!0))),t.upgradeMaterialViewArr.push(l)}}t.groupGoShop.visible=0==a}},t.prototype.cleanUpgradeMaterialViewArr=function(){var e=this;if(e.curSelMaterialView=null,null!=e.upgradeMaterialViewArr&&0!=e.upgradeMaterialViewArr.length)for(var t=e.upgradeMaterialViewArr.length-1;t>=0;t--){var r=e.upgradeMaterialViewArr[t];null!=r&&null!=r.parent&&r.parent.removeChild(r),e.upgradeMaterialViewArr.splice(t,1)}},t.prototype.onResize=function(t){e.prototype.onResize.call(this,t);var r=this;if(null!=r.groupRoleUpgrade){var a=GlobalDef.SCREEN_WIDTH>GlobalDef.SCREEN_HEIGHT?GlobalDef.SCREEN_WIDTH:GlobalDef.SCREEN_HEIGHT,n=GlobalDef.SCREEN_WIDTH>GlobalDef.SCREEN_HEIGHT?GlobalDef.SCREEN_HEIGHT:GlobalDef.SCREEN_WIDTH,o=r.$stage.stageWidth,i=r.$stage.stageHeight,l=Number((o/i/(a/n)).toFixed(2));return l>1||0>l?void(r.groupRoleUpgrade.scaleX=r.groupRoleUpgrade.scaleY=1):void(r.groupRoleUpgrade.scaleX=r.groupRoleUpgrade.scaleY=l)}},t.NAME="RoleUpgradeSkin",t}(BaseView);__reflect(RoleUpgradeView.prototype,"RoleUpgradeView");var MallView=function(e){function t(){var r=e.call(this,t.NAME)||this;return r.arrOptionBtn=new Array,r.arrPropItem=new Array,r.discribeList=["全部","经验书","场景","牌背","其他"],r.mallName=[],r.kindList=[0,2,8,7,-1],r.curBtnIdx=0,r.tempList=[],r.pageNum=1,r.pageSize=10,r.receiveNum=0,r.needUp=!1,r}return __extends(t,e),t.prototype.week=function(){var e=this;e.hasEventListener(egret.TouchEvent.TOUCH_TAP)||e.addEventListener(egret.TouchEvent.TOUCH_TAP,e.touchTap,e),e.scrPropItem.addEventListener(eui.UIEvent.CHANGE,e.moveHandler,e),e.scrPropItem.addEventListener(eui.UIEvent.CHANGE_END,e.outHandler,e),this.pageNum=1,this.needUp=!1,this.receiveNum=0,e.updateGold(),e.setOptionBtn(),e.sendGetShopList()},t.prototype.sendGetShopList=function(){var e=GlobalDataManager.getInstance().getCenterServer(),t=new Object;t.param="商城",HttpManager.getInstance().send(e.getSname(),HallCmdDef.CMD_Shop,t,!0)},t.prototype.moveHandler=function(e){this.scrPropItem.viewport.scrollV>this.scrPropItem.viewport.contentHeight-this.scrPropItem.viewport.height-40&&(this.needUp=!0)},t.prototype.outHandler=function(e){this.receiveNum<this.pageSize&&(this.needUp=!1),this.needUp&&(this.needUp=!1,this.addNewData())},t.prototype.addNewData=function(){this.pageNum=this.pageNum+1,this.sendGetShopList()},t.prototype.updateGold=function(){var e=GlobalDataManager.getInstance().getAccountData();this.comStar.txt.text=e.gold},t.prototype.sleep=function(){var e=this;e.cleanArray(e.arrOptionBtn),e.cleanArray(e.arrPropItem),e.curChooseOptionBtnIndex=null},t.prototype.cleanArray=function(e){if(!(null==e||e.length<=0))for(var t=e.length-1;t>=0;t--){var r=e[t];if(null!=r){var a=r.parent;a.removeChild(r)}e.splice(t,1)}},t.prototype.recvData=function(e,t){var r=this;switch(e){case HallCmdDef.CMD_GET_MOLL_CONFIG:var a=(t.shopDesc,t.shopName,t.length);this.receiveNum=a;for(var n=0;a>n;n++){var o=t[n];(this.pageNum-1)*this.pageSize+n;r.mallName[o.shopOrder-1]=o}a>0&&r.setCurChooseOptionBtnByIndex(0);break;case HallCmdDef.CMD_GET_MOLLBY_CONFIG:var a=(t.msg,t.itemIdx,t.buyNum),i=t.curGold,l=t.shopOrder,s=t.msg,c=t.errorString;if(0==s)PopManager.getInstance().showPromptBox(c,2,Handler.create(r,function(e){console.log("回调函数被调用")}));else{for(var p=0;p<r.mallName.length;p++)r.mallName[p].shopOrder==l&&(r.mallName[p].shopNum=r.mallName[p].shopNum+parseInt(a));var u=GlobalDataManager.getInstance().getAccountData();u.setGold(i),r.updateGold(),r.setPropItem(r.kindList[r.curBtnIdx])}}},t.prototype.touchTap=function(e){var t=this;if(e.target instanceof eui.Button){var r=e.target;if("btnOption_"==r.name.substr(0,10)){var a=r.name.split("_");
if(2!=a.length)return;var n=Number(a[1]);t.setCurChooseOptionBtnByIndex(n),console.log("选择按钮被按下："+n)}else if("btnBuy_"==r.name.substr(0,7)){var a=r.name.split("_");if(2!=a.length)return;var n=Number(a[1]);console.log("选择的商品被按下："+n),UIManager.getInstance().showUI(MPropExplainView,GameScene.VIEW_LAYER_NUMBER,-1,0,0,0,{type:t.tempList[n],idx:n})}else r==t.btnBack&&t.hiden()}},t.prototype.setOptionBtn=function(){for(var e=this,t=0;5>t;t++){var r=new OptionBtnView;r.init(),e.groupOptionBtn.addChild(r),r.setBtnContent(e.discribeList[t]),r.setBtnName("btnOption_"+t),r.x=0,e.arrOptionBtn.push(r),r.width=r.getViewWidth(),r.height=r.getViewHeight()}},t.prototype.setCurChooseOptionBtnByIndex=function(e){var t=this,r=null;if(null!=t.curChooseOptionBtnIndex){if(t.curChooseOptionBtnIndex==e)return;if(r=t.getOptionBtnViewByIndex(t.curChooseOptionBtnIndex),null==r)return;r.setCurChoose(0,!0)}t.curChooseOptionBtnIndex=e,r=t.getOptionBtnViewByIndex(e),null!=r&&(r.setCurChoose(1,!0),t.updateOptionBtnPos(),t.cleanArray(t.arrPropItem),t.curBtnIdx=e,t.setPropItem(t.kindList[e]))},t.prototype.getOptionBtnViewByIndex=function(e){for(var t=null,r=this,a=0,n=r.arrOptionBtn.length;n>a;a++){var o=r.arrOptionBtn[a];if(null!=o){var i=o.getBtnName(),l=i.split("_");if(2==l.length){var s=Number(l[1]);if(e==s){t=o;break}}}}return t},t.prototype.updateOptionBtnPos=function(){for(var e=this,t=0,r=0,a=e.arrOptionBtn.length;a>r;r++){var n=e.arrOptionBtn[r];null!=n&&(n.y=t,t+=n.getViewHeight()+10)}e.scrOptionBtn.height=t},t.prototype.setPropItem=function(e){var t=this,r=4,a=0,n=t.scrPropItem.width/r,o=0;t.tempList=[];for(var i=0,l=0;l<t.mallName.length;l++)0!=e?t.mallName[l].pcode==e&&(t.tempList[i]=t.mallName[l],i+=1):(t.tempList[i]=t.mallName[l],i+=1);for(var s=t.tempList.length,l=0;s>l;l++){var c=new MPropItemView,p={name:t.tempList[l].shopName,idx:l,price:t.tempList[l].price,icon:t.tempList[l].resUrl};c.setData(p),c.init(),t.groupPropItem.addChild(c),c.x=a*n+10,c.y=o*(c.getViewHeight()+18)+15,c.width=c.getViewWidth(),c.height=c.getViewHeight(),c.setBtnName("btnBuy_"+l),t.arrPropItem.push(c),a+=1,a>=r&&(a=0,o++)}},t.prototype.onResize=function(t){e.prototype.onResize.call(this,t);var r=this;if(null!=r.mallskingroup){var a=GlobalDef.SCREEN_WIDTH>GlobalDef.SCREEN_HEIGHT?GlobalDef.SCREEN_WIDTH:GlobalDef.SCREEN_HEIGHT,n=GlobalDef.SCREEN_WIDTH>GlobalDef.SCREEN_HEIGHT?GlobalDef.SCREEN_HEIGHT:GlobalDef.SCREEN_WIDTH,o=r.$stage.stageWidth,i=r.$stage.stageHeight,l=Number((o/i/(a/n)).toFixed(2));return l>1||0>l?void(r.mallskingroup.scaleX=r.mallskingroup.scaleY=1):void(r.mallskingroup.scaleX=r.mallskingroup.scaleY=l)}},t.NAME="MallSkin",t}(BaseView);__reflect(MallView.prototype,"MallView");var MPropExplainView=function(e){function t(){var r=e.call(this,t.NAME)||this;return r.oldString="",r}return __extends(t,e),t.prototype.week=function(){var t=this;t.hasEventListener(egret.TouchEvent.TOUCH_TAP)||t.addEventListener(egret.TouchEvent.TOUCH_TAP,t.touchTap,t);var r=e.prototype.getData.call(this);if(null!=r){var a=r.type;this.selectNum=1,this.maxNum=a.shopNum,this.totalnum.text="（购买花费："+this.selectNum*a.price+")",this.editCount.text=this.selectNum+"",this.nameandnum.text=a.shopNum+" 个",this.namstring.text=a.shopName,this.descstring.text=a.shopDesc,this.price.text=a.price,this.itemPrice=a.price,this.shopOrder=a.shopOrder,this.shopKind=a.shopKind,this.itemIdx=r.idx,t.setIcon(a.resUrl),t.editCount.addEventListener(eui.UIEvent.CHANGE,t.moveHandler,t),t.editCount.addEventListener(eui.UIEvent.CHANGE_END,t.outHandler,t)}},t.prototype.setIcon=function(e){""!=e&&(this.imgItem.source="hallImg1Sheet_json."+e)},t.prototype.sleep=function(){},t.prototype.isNumber=function(e){var t=/^\d+(\.\d+)?$/,r=/^(-(([0-9]+\.[0-9]*[1-9][0-9]*)|([0-9]*[1-9][0-9]*\.[0-9]+)|([0-9]*[1-9][0-9]*)))$/;return t.test(e)||r.test(e)?!0:!1},t.prototype.moveHandler=function(e){var t=this;this.editCount.text.length>7&&(this.editCount.text=t.oldString),1==t.isNumber(this.editCount.text)?t.oldString=this.editCount.text:this.editCount.text=t.oldString;var r=parseInt(this.editCount.text);1==t.isNumber(this.editCount.text)&&(this.totalnum.text="（购买花费："+r*this.itemPrice+")")},t.prototype.outHandler=function(e){var t=this,r=parseInt(this.editCount.text);1==t.isNumber(this.editCount.text)&&(this.totalnum.text="（购买花费："+r*this.itemPrice+")")},t.prototype.touchTap=function(e){var t=this,r=e.target;if(r instanceof eui.Button)if(r==t.btnConfirm){t.hiden();var a=parseInt(this.editCount.text);if(0==t.isNumber(this.editCount.text))return void PopManager.getInstance().showPromptBox("请输入正确数字",2,Handler.create(t,function(e){console.log("回调函数被调用")}));var n=Math.floor(a);if(a=parseInt(this.editCount.text),a>n||0>=a||a>=1e5)return void PopManager.getInstance().showPromptBox("请输入正确整数",2,Handler.create(t,function(e){console.log("回调函数被调用")}));var o=new Object;o.shopOrder=""+this.shopOrder,o.shopKind=""+this.shopKind,o.price=""+this.itemPrice,o.buyNum=""+a,o.itemIdx=""+this.itemIdx;var i=GlobalDataManager.getInstance().getCenterServer();HttpManager.getInstance().send(i.getSname(),HallCmdDef.CMD_ShopBy,o,!0)}else r==t.btnCancel?t.hiden():r==t.btnReduce?(this.selectNum>1&&(this.selectNum=this.selectNum-1),this.editCount.text=this.selectNum+"",this.totalnum.text="（购买花费："+this.selectNum*this.itemPrice+")"):r==t.btnAdd?(this.selectNum<this.maxNum&&(this.selectNum=this.selectNum+1),this.editCount.text=this.selectNum+"",this.totalnum.text="（购买花费："+this.selectNum*this.itemPrice+")"):r==t.btnMax&&(this.selectNum=this.maxNum,this.editCount.text=this.selectNum+"",this.totalnum.text="（购买花费："+this.selectNum*this.itemPrice+")");else r instanceof eui.Rect&&r==t.rectBG&&t.hiden()},t.NAME="MPropExplainSkin",t}(BaseView);__reflect(MPropExplainView.prototype,"MPropExplainView");var MPropItemView=function(e){function t(){return e.call(this,t.NAME)||this}return __extends(t,e),t.prototype.week=function(){var t=this,r=e.prototype.getData.call(this);if(null!=r){var a=r.name;this.thename.text=a,this.price.text=r.price,this.btnBuy.label="购买:"+r.price,t.setIcon(r.icon)}},t.prototype.sleep=function(){},t.prototype.setIcon=function(e){""!=e&&(this.imgItem.source="hallImg1Sheet_json."+e)},t.prototype.getViewWidth=function(){return this.groupPI.width},t.prototype.getViewHeight=function(){return this.groupPI.height},t.prototype.setBtnName=function(e){this.btnBuy.name=e},t.NAME="MPropItemSkin",t}(BaseView);__reflect(MPropItemView.prototype,"MPropItemView");var MatchingView=function(e){function t(){var r=e.call(this,t.NAME)||this;return r.loopReqMatchInfoIndex=-1,r.loopReqTime=3,r}return __extends(t,e),t.prototype.week=function(){var e=this;e.hasEventListener(egret.TouchEvent.TOUCH_TAP)||e.addEventListener(egret.TouchEvent.TOUCH_TAP,e.touchTap,e),e.initView(),e.sendMatch()},t.prototype.initView=function(){var e=this;e.loopReqMatchInfoIndex=-1,e.timeCounter=0,e.updateTimeShow(),e.startRotate(),e.startTimer(),e.setHintTextField()},t.prototype.sleep=function(){var e=this;e.hasEventListener(egret.TouchEvent.TOUCH_TAP)&&e.removeEventListener(egret.TouchEvent.TOUCH_TAP,e.touchTap,e),e.stopRotate(),e.stopTimer(),null!=e.timer&&(e.timer.removeEventListener(egret.TimerEvent.TIMER,e.timerFunc,e),e.timer=null),null!=e.hintTextField&&(e.hintTextField.parent.removeChild(e.hintTextField),e.hintTextField=null)},t.prototype.touchTap=function(e){var t=this,r=e.target;r instanceof eui.Button&&r==t.btnStop&&t.sendDisMatch()},t.prototype.startRotate=function(){var e=this;e.stopRotate(),e.imgRotate.rotation=0,egret.Tween.get(e.imgRotate,{loop:!0}).to({rotation:360},2500)},t.prototype.stopRotate=function(){egret.Tween.removeTweens(this.imgRotate)},t.prototype.startTimer=function(){var e=this;null==e.timer&&(e.timer=new egret.Timer(1e3,0),e.timer.addEventListener(egret.TimerEvent.TIMER,e.timerFunc,e),e.timeCounter=0),e.timer.start()},t.prototype.stopTimer=function(){var e=this;null!=e.timer&&e.timer.stop()},t.prototype.timerFunc=function(){var e=this;e.timeCounter++,e.updateTimeShow(),-1!=e.loopReqMatchInfoIndex&&(e.loopReqMatchInfoIndex--,0==e.loopReqMatchInfoIndex&&e.sendGetMatchInfo())},t.prototype.updateTimeShow=function(){var e=this;e.lblTime.text=e.parseTime(e.timeCounter)},t.prototype.parseTime=function(e){0>e&&(e=0);var t=e%60,r=Math.floor(e/60),a=10>t?"0"+t:""+t,n=10>r?"0"+r:""+r;return n+":"+a},t.prototype.setHintTextField=function(){var e=this,t=new egret.TextField;t.textColor=16777215,t.size=36,e.groupHint.addChild(t),t.fontFamily="SimHei",t.textFlow=[{text:"温馨提示:",style:{size:36,textColor:16769945}},{text:"点击下面按钮可关闭界面",style:{size:30,textColor:8443388}}],e.hintTextField=t,e.groupHint.width=t.width},t.prototype.sendMatch=function(){var e=GlobalDataManager.getInstance().getCenterServer();HttpManager.getInstance().send(e.getSname(),HallCmdDef.CMD_MATCH_PVP,{gcid:0},!1)},t.prototype.sendDisMatch=function(){var e=GlobalDataManager.getInstance().getCenterServer();HttpManager.getInstance().send(e.getSname(),HallCmdDef.CMD_DISMATCH_PVP,{})},t.prototype.sendGetMatchInfo=function(){var e=GlobalDataManager.getInstance().getCenterServer();HttpManager.getInstance().send(e.getSname(),HallCmdDef.CMD_GET_MATCH_PVP_INFO,{},!1)},t.prototype.recvData=function(e,t){var r=this;switch(e){case HallCmdDef.CMD_MATCH_PVP:r.onGetMatchPvp(t);break;case HallCmdDef.CMD_DISMATCH_PVP:r.hiden();break;case HallCmdDef.CMD_GET_MATCH_PVP_INFO:r.onGetMatchInfo(t)}},t.prototype.onGetMatchPvp=function(e){if(null!=e){var t=this,r=e.msg;if(null!=e.result&&e.result!=GlobalDef.REQUEST_SUCCESS){t.stopTimer();var a=null;if(a=-108==r?Handler.create(t,function(){t.hiden(),UIManager.getInstance().showUI(CardGroupView)}):Handler.create(t,function(){t.hiden()}),ErrorMananger.getInstance().checkReqResult(e,!0,a))return}null!=r&&null!=r.ruuid?t.openWebSocket(r):t.sendGetMatchInfo()}},t.prototype.onGetMatchInfo=function(e){if(null!=e){var t=this,r=e.msg;if(null!=e.result&&e.result!=GlobalDef.REQUEST_SUCCESS){t.stopTimer();var a=Handler.create(t,function(){t.hiden()});if(ErrorMananger.getInstance().checkReqResult(e,!0,a))return}return null==r||0==r?void t.loopSendGetMatchInfo():void t.openWebSocket(r)}},t.prototype.openWebSocket=function(e){if(null!=e){var t=e.ruuid;GlobalDataManager.getInstance().setRUUID(t);var r=e.room;GlobalDataManager.getInstance().setRoom(r),GlobalDataManager.getInstance().setThredID(0);var a=e.scode;GlobalDataManager.getInstance().setGameServerName(a),GlobalDataManager.getInstance().setGameOver(!1);var n=e.surl,o=new ServerData;o.setSname(a),o.setSurl(n),o.setResolver(WebSocketManager.getInstance().getResolver(JsonResolver.NAME)),WebSocketManager.getInstance().registerServer(o),WebSocketManager.getInstance().connectServer(a,!0)}},t.prototype.loopSendGetMatchInfo=function(){var e=this;e.loopReqMatchInfoIndex=e.loopReqTime},t.NAME="MatchingSkin",t}(BaseView);__reflect(MatchingView.prototype,"MatchingView");var PackageView=function(e){function t(){var r=e.call(this,t.NAME)||this;return r.mallName=[],r.kindList=[0,2,8,7,-1],r.curBtnIdx=0,r.curItemIdx=0,r.tempList=[],r.arrOptionBtn=new Array,r.arrPropItem=new Array,r.needUp=!1,r.hIndex=0,r.vIndex=0,r.pageNum=1,r.pageSize=10,r.receiveNum=0,r}return __extends(t,e),t.prototype.week=function(){var e=this;e.hasEventListener(egret.TouchEvent.TOUCH_TAP)||e.addEventListener(egret.TouchEvent.TOUCH_TAP,e.touchTap,e),e.scrPropItem.addEventListener(eui.UIEvent.CHANGE,e.moveHandler,e),e.scrPropItem.addEventListener(eui.UIEvent.CHANGE_END,e.outHandler,e),this.pageNum=1,this.needUp=!1,this.receiveNum=0,e.setOptionBtn(),this.setItemInfo(null),e.sendGetBagList()},t.prototype.sendGetBagList=function(){var e=new Object;e.param="背包",e.pageid=this.pageNum,e.pageSize=this.pageSize;var t=GlobalDataManager.getInstance().getCenterServer();HttpManager.getInstance().send(t.getSname(),HallCmdDef.CMD_Bag,e,!0)},t.prototype.sleep=function(){var e=this;e.cleanArray(e.arrOptionBtn),e.cleanArray(e.arrPropItem),e.curChooseOptionBtnIndex=null,e.hIndex=0,e.vIndex=0,e.scrPropItem.viewport.scrollV=0,e.scrPropItem.viewport.scrollH=0},t.prototype.cleanArray=function(e){if(!(null==e||e.length<=0))for(var t=e.length-1;t>=0;t--){var r=e[t];if(null!=r){var a=r.parent;a.removeChild(r)}e.splice(t,1)}},t.prototype.recvData=function(e,t){var r=this;switch(e){case HallCmdDef.CMD_Bag:var a=t.length;this.receiveNum=a;for(var n=0;a>n;n++){var o=t[n],i=(this.pageNum-1)*this.pageSize+n;r.mallName[i]=o}a>0&&r.setPropItem(0,0);break;case HallCmdDef.CMD_Baguse:case HallCmdDef.CMD_BagDestory:for(var l=(t.msg,t.itemIdx),s=t.bagId,c=(t.shopKind,t.shop_num),n=0;n<r.mallName.length;n++)r.mallName[n].bagId==s&&(r.mallName[n].shopNum=c);r.hIndex=0,r.vIndex=0,r.cleanArray(r.arrPropItem),r.setPropItem(r.kindList[r.curBtnIdx],l)}},t.prototype.touchTap=function(e){var t=this;if(e.target instanceof eui.Button){var r=e.target;if("btnOption_"==r.name.substr(0,10)){var a=r.name.split("_");if(2!=a.length)return;var n=Number(a[1]);t.setCurChooseOptionBtnByIndex(n),t.cleanArray(t.arrPropItem),t.hIndex=0,t.vIndex=0,t.scrPropItem.viewport.scrollV=0,t.scrPropItem.viewport.scrollH=0,t.curBtnIdx=n,t.setPropItem(t.kindList[n],0)}else if(r==t.btnBack)t.hiden();else if(r==t.btnUse){var o=t.tempList[t.curItemIdx],i=o.shopKind;if(1==i||2==i||3==i||4==i){UIManager.getInstance().showUI(CardView);var l=new Object;l.param="卡牌"}else PopManager.getInstance().showPromptBox("使用暂未解锁",2,Handler.create(t,function(e){console.log("回调函数被调用")}))}else if(r==t.btnDestory){var s=function(){console.log("回调函数被调用,调用id");var e=t.tempList[t.curItemIdx],r=e.bagId,a=new Object;a.bagId=r,a.shop_kind=e.shopKind,a.itemIdx=t.curItemIdx,a.usetype=!1;var n=GlobalDataManager.getInstance().getCenterServer();HttpManager.getInstance().send(n.getSname(),HallCmdDef.CMD_BagDestory,a,!0)},o={name:"被摧毁物品将无法找回！是否确定摧毁？",fun:s};UIManager.getInstance().showUI(DailogView,GameScene.VIEW_LAYER_NUMBER,-1,0,0,0,o)}}else if(e.target instanceof eui.Group){var c=e.target;if("groupPI_"==c.name.substr(0,8)){var a=c.name.split("_");if(2!=a.length)return;var n=Number(a[1]);console.log(n);new PPropExplainView;this.curItemIdx=n,this.setItemInfo(this.curItemIdx)}}},t.prototype.setLight=function(e){for(var t=this.arrPropItem.length-1;t>=0;t--){var r=this.arrPropItem[t];null!=r&&(t==e?r.setBeenSelect(!0):r.setBeenSelect(!1))}},t.prototype.setItemInfo=function(e){var t=this.tempList[e];return null==t?void this.infogroup.$setVisible(!1):(this.infogroup.$setVisible(!0),this.iconname.text=t.shopName,this.num.text=t.shopNum,this.disc.text=t.shopDesc,this.price.text=t.price,this.imgItem.source="hallImg1Sheet_json."+t.resUrl,void this.setLight(e))},t.prototype.moveHandler=function(e){this.scrPropItem.viewport.scrollV>this.scrPropItem.viewport.contentHeight-this.scrPropItem.viewport.height-40&&(this.needUp=!0)},t.prototype.outHandler=function(e){this.receiveNum<this.pageSize&&(this.needUp=!1),this.needUp&&(this.needUp=!1,this.addNewData())},t.prototype.addNewData=function(){this.pageNum=this.pageNum+1,this.sendGetBagList()},t.prototype.setOptionBtn=function(){for(var e=this,t=["全部","经验书","场景","牌背","其他"],r=0;5>r;r++){var a=new OptionBtnView;a.init(),e.groupOptionBtn.addChild(a),a.setBtnContent(t[r]),a.setBtnName("btnOption_"+r),a.x=10,e.arrOptionBtn.push(a),a.width=a.getViewWidth(),a.height=a.getViewHeight()}e.setCurChooseOptionBtnByIndex(0)},t.prototype.setCurChooseOptionBtnByIndex=function(e){var t=this,r=null;if(null!=t.curChooseOptionBtnIndex){if(t.curChooseOptionBtnIndex==e)return;if(r=t.getOptionBtnViewByIndex(t.curChooseOptionBtnIndex),null==r)return;r.setCurChoose(0,!0)}t.curChooseOptionBtnIndex=e,r=t.getOptionBtnViewByIndex(e),null!=r&&(r.setCurChoose(1,!0),t.updateOptionBtnPos())},t.prototype.getOptionBtnViewByIndex=function(e){for(var t=null,r=this,a=0,n=r.arrOptionBtn.length;n>a;a++){var o=r.arrOptionBtn[a];if(null!=o){var i=o.getBtnName(),l=i.split("_");if(2==l.length){var s=Number(l[1]);if(e==s){t=o;break}}}}return t},t.prototype.updateOptionBtnPos=function(){for(var e=this,t=0,r=0,a=e.arrOptionBtn.length;a>r;r++){var n=e.arrOptionBtn[r];null!=n&&(n.y=t,t+=n.getViewHeight()+10)}e.scrOptionBtn.height=t},t.prototype.setPropItem=function(e,t){var r=this,a=5;r.tempList=[];for(var n=0,o=0;o<r.mallName.length;o++)0!=e?r.mallName[o].shopKind==e&&r.mallName[o].shopNum>0&&(r.tempList[n]=r.mallName[o],n+=1):r.mallName[o].shopNum>0&&(r.tempList[n]=r.mallName[o],n+=1);if(-1==e){r.tempList=[],n=0;for(var o=0;o<r.mallName.length;o++)r.mallName[o].shopKind!=r.kindList[1]&&r.mallName[o].shopKind!=r.kindList[2]&&r.mallName[o].shopKind!=r.kindList[3]&&r.mallName[o].shopNum>0&&(r.tempList[n]=r.mallName[o],n+=1)}for(var i=r.scrPropItem.width/a,l=r.tempList.length,o=0;l>o;o++){var s=new PPropItemView2,c={icon:r.tempList[o].resUrl,name:r.tempList[o].shopName,num:r.tempList[o].shopNum};s.initData(c),r.groupPropItem.addChild(s),s.x=r.hIndex*i+10,s.y=r.vIndex*(s.getViewHeight()+17)+13,s.width=s.getViewWidth(),s.height=s.getViewHeight(),s.setGroupName("groupPI_"+o),r.arrPropItem.push(s),r.hIndex++,r.hIndex>=a&&(r.hIndex=0,r.vIndex++)}this.curItemIdx=t,this.setItemInfo(this.curItemIdx)},t.prototype.onResize=function(t){e.prototype.onResize.call(this,t);var r=this;if(null!=r.groupPackage){var a=GlobalDef.SCREEN_WIDTH>GlobalDef.SCREEN_HEIGHT?GlobalDef.SCREEN_WIDTH:GlobalDef.SCREEN_HEIGHT,n=GlobalDef.SCREEN_WIDTH>GlobalDef.SCREEN_HEIGHT?GlobalDef.SCREEN_HEIGHT:GlobalDef.SCREEN_WIDTH,o=r.$stage.stageWidth,i=r.$stage.stageHeight,l=Number((o/i/(a/n)).toFixed(2));return l>1||0>l?void(r.groupPackage.scaleX=r.groupPackage.scaleY=1):void(r.groupPackage.scaleX=r.groupPackage.scaleY=l)}},t.NAME="PackageSkin",t}(BaseView);__reflect(PackageView.prototype,"PackageView");var PPropExplainView=function(e){function t(){var r=e.call(this,t.NAME)||this;return r.bagid=0,r}return __extends(t,e),t.prototype.week=function(){var t=this,t=this,r=e.prototype.getData.call(this);if(null!=r){var a=r.type,n="";t.setIcon(n);var o=a.shopName,i=a.shopNum;t.setItemName(o,i);var l=a.shop_desc;t.setItemTips(l);var s=a.price;t.setItemCost(s),t.bagid=a.bagId,this.itemIdx=r.idx,t.hasEventListener(egret.TouchEvent.TOUCH_TAP)||t.addEventListener(egret.TouchEvent.TOUCH_TAP,t.touchTap,t)}},t.prototype.sleep=function(){},t.prototype.touchTap=function(e){var t=this,r=e.target;if(r instanceof eui.Button){if(r==t.btnUse){t.hiden();var a=new Object;a.bagId=t.bagid,a.itemIdx=t.itemIdx;var n=GlobalDataManager.getInstance().getCenterServer();HttpManager.getInstance().send(n.getSname(),HallCmdDef.CMD_Baguse,a,!0)}}else r instanceof eui.Rect&&r==t.rectBG&&t.hiden()},t.prototype.setIcon=function(e){null==e&&"undefine"==e&&(this.imgItem.source=e)},t.prototype.setItemName=function(e,t){this.labItemName.text=e+" (拥有"+t+"件)"},t.prototype.setItemTips=function(e){this.labTips.text=e},t.prototype.setItemCost=function(e){this.labCost.text="（购买花费: "+e+"XWG)"},t.NAME="PPropExplainSkin",t}(BaseView);__reflect(PPropExplainView.prototype,"PPropExplainView");var PPropItemView=function(e){function t(){return e.call(this,t.NAME)||this}return __extends(t,e),t.prototype.week=function(){var t=this,r=e.prototype.getData.call(this);null!=r&&(t.setName(r.name),t.setItemNum(r.num),t.setIcon(r.icon))},t.prototype.sleep=function(){},t.prototype.setName=function(e){this.labItemName.text=e},t.prototype.setIcon=function(e){""!=e&&(this.imgItem.source=e)},t.prototype.setItemNum=function(e){this.labItemNum.text=""+e},t.prototype.getViewWidth=function(){return this.groupPI.width},t.prototype.getViewHeight=function(){return this.groupPI.height},t.prototype.setGroupName=function(e){this.groupPI.name=e},t.NAME="PPropItemSkin",t}(BaseView);__reflect(PPropItemView.prototype,"PPropItemView");var PPropItemView2=function(e){function t(){return e.call(this,t.NAME)||this}return __extends(t,e),t.prototype.week=function(){var t=this,r=e.prototype.getData.call(this);null!=r&&(t.setName(r.name),t.setItemNum(r.num),t.setIcon(r.icon),t.selcetLight.$setVisible(!1))},t.prototype.sleep=function(){},t.prototype.setName=function(e){},t.prototype.setIcon=function(e){""!=e&&(this.imgItem.source="hallImg1Sheet_json."+e)},t.prototype.setItemNum=function(e){this.labItemNum.text=""+e},t.prototype.getViewWidth=function(){return this.groupPI.width},t.prototype.setBeenSelect=function(e){this.selcetLight.$setVisible(e)},t.prototype.getViewHeight=function(){return this.groupPI.height},t.prototype.setGroupName=function(e){this.groupPI.name=e},t.NAME="PPropItemSkin2",t}(BaseView);__reflect(PPropItemView2.prototype,"PPropItemView2");